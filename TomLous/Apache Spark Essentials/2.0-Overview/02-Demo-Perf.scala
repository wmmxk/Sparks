{"version":"NotebookV1","origId":503877321548446,"name":"02-Demo-Perf","language":"scala","commands":[{"version":"CommandV1","origId":503877321548448,"guid":"43bb1f19-688a-43c4-a624-09793b0fdd6a","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n# Webinar Demo 3. Performance","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7153c3b0-6b63-4fbf-9e88-f3a482e5c4db"},{"version":"CommandV1","origId":503877321548449,"guid":"67638245-5c1a-4ff0-a3c9-b04c4de4575b","subtype":"command","commandType":"auto","position":2.0,"command":"// Define a simple benchmark function for measuring time taken\ndef benchmark(name: String)(f: => Unit): Unit = {\n  val startTime = System.nanoTime\n  try {\n    f\n  }\n  finally {\n    val endTime = System.nanoTime\n    println(s\"Time taken in $name: \" + (endTime - startTime).toDouble / 1000000000 + \" seconds\")\n  }\n}","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0a82623f-1e43-4d4b-be89-ae7328f19656"},{"version":"CommandV1","origId":503877321548450,"guid":"7b97fc4f-4b6c-41b6-97cf-552a3ae1d80a","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n### How fast can Spark 1.6 sum up 1 billion numbers?","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cbec56fa-8920-4fff-8f23-f3561e877e07"},{"version":"CommandV1","origId":503877321548451,"guid":"ba134db1-de98-4bd8-b481-9aaeb10d7b23","subtype":"command","commandType":"auto","position":4.0,"command":"// This config turns off whole stage code generation, effectively changing the execution path to be similar to Spark 1.6.\nspark.conf.set(\"spark.sql.codegen.wholeStage\", false)\n\nbenchmark(\"Spark 1.6\") {\n  spark.range(1000L * 1000 * 1000).selectExpr(\"sum(id)\").show()\n}","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f6c8fd88-6299-4ed9-b2b8-0025e587f997"},{"version":"CommandV1","origId":503877321548452,"guid":"6278a223-1c75-49e7-aba0-392b5d31e38f","subtype":"command","commandType":"auto","position":5.0,"command":"%md\n### How fast can Spark 1.6 join 1 billion records?","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"588a011a-d642-4ec8-96f1-8c0020b61533"},{"version":"CommandV1","origId":503877321548453,"guid":"2d874d77-0f3d-41ac-b9e3-7c396ee47d19","subtype":"command","commandType":"auto","position":6.0,"command":"// This config turns off whole stage code generation, effectively changing the execution path to be similar to Spark 1.6.\nspark.conf.set(\"spark.sql.codegen.wholeStage\", false)\n\nbenchmark(\"Spark 1.6\") {\n  spark.range(1000L * 1000 * 1000).join(spark.range(1000L).toDF(), \"id\").count()\n}","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ec0ce814-00d0-4a2a-910f-e56504139676"},{"version":"CommandV1","origId":503877321548454,"guid":"5c7ad9de-2986-4bd9-a5a6-7dabef5cd496","subtype":"command","commandType":"auto","position":7.0,"command":"%md\n### How fast can Spark 2.0 sum up 1 billion numbers?","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"061f2d7a-2071-4526-a807-b55200e3191a"},{"version":"CommandV1","origId":503877321548455,"guid":"65b0903c-745f-43d1-8086-b7426859c0c3","subtype":"command","commandType":"auto","position":8.0,"command":"spark.conf.set(\"spark.sql.codegen.wholeStage\", true)\n\nbenchmark(\"Spark 2.0\") {\n  spark.range(1000L * 1000 * 1001).selectExpr(\"sum(id)\").show()\n}","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f986b6a5-f7b7-4cbd-b573-c028b52fe22d"},{"version":"CommandV1","origId":503877321548456,"guid":"8937c5c5-e349-451e-a808-84d43f52f847","subtype":"command","commandType":"auto","position":9.0,"command":"%md\n### How fast can Spark 2.0 join 1 billion records?","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"50b87b26-0e03-4e19-a667-27ad64080d0f"},{"version":"CommandV1","origId":503877321548457,"guid":"9a58b300-ef3e-4631-a180-d2480ce9534f","subtype":"command","commandType":"auto","position":10.0,"command":"spark.conf.set(\"spark.sql.codegen.wholeStage\", true)\n\nbenchmark(\"Spark 2.0\") {\n  spark.range(1000L * 1000 * 1005).join(spark.range(1040L).toDF(), \"id\").count()\n}","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"03cb7bf7-99c9-49c9-85e1-b8a45a0f037d"},{"version":"CommandV1","origId":503877321548458,"guid":"53bf4585-cc9a-4ab6-9986-47dedee4b207","subtype":"command","commandType":"auto","position":11.0,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8c1b4059-919a-4c32-8732-e2fc41913935"}],"dashboards":[],"guid":"54a1ff0b-d30a-47c5-8c8b-9ff8d9b0e592","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}