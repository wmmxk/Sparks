{"version":"NotebookV1","origId":503877321548161,"name":"Compute-Average-Scala","language":"scala","commands":[{"version":"CommandV1","origId":503877321548163,"guid":"117f9098-cef7-4f3b-86e0-e0d83d945ea6","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n# DataFrames = less code","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e29dee38-068d-41fc-a778-9bae2210aaea"},{"version":"CommandV1","origId":503877321548164,"guid":"f5d3f953-d176-4807-ba10-cb58100ef855","subtype":"command","commandType":"auto","position":2.0,"command":"val Data = Array(\n  \"coffee 10\",\n  \"coffee 20\",\n  \"coffee 32\",\n  \"tea 10\",\n  \"tea 15\",\n  \"tea 29\"\n)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"89e301aa-c1e3-429c-9e26-55f0bd7f73e3"},{"version":"CommandV1","origId":503877321548165,"guid":"a3a5dc2e-efd2-4673-8793-3f45b3fa43db","subtype":"command","commandType":"auto","position":3.0,"command":"var rdd = sc.parallelize(Data).map(_.split(\" \"))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f4e654c4-3883-4c59-8de0-7a7b17b88f98"},{"version":"CommandV1","origId":503877321548166,"guid":"d0ae48bf-5e34-4f95-b377-e8b62ed5c6d8","subtype":"command","commandType":"auto","position":4.0,"command":"%md Here it is, not broken down:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3e01662e-2ae7-4aa2-b587-4d4cdff5ee12"},{"version":"CommandV1","origId":503877321548167,"guid":"baff13ce-6ed0-4b30-a2e8-c6f302c4e1c5","subtype":"command","commandType":"auto","position":5.0,"command":"rdd.map { x => (x(0), (x(1).toFloat, 1)) }.\n    reduceByKey { case ((num1, count1), (num2, count2)) => \n      (num1 + num2, count1 + count2) \n    }.\n    map { case (key, (num, count)) => (key, num / count) }.\n    collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3b3c451f-7357-4fc0-8232-6c37dca63e78"},{"version":"CommandV1","origId":503877321548168,"guid":"b9294c3e-61be-4b48-a95b-89ca52f6d03a","subtype":"command","commandType":"auto","position":6.0,"command":"%md If you break it down into steps, you can see what's going on.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4fc339f9-19ee-4252-bf51-30b40794e4fe"},{"version":"CommandV1","origId":503877321548169,"guid":"f77e4b1e-3162-4adf-b411-1595c8ca4514","subtype":"command","commandType":"auto","position":7.0,"command":"val d2 = rdd.map { x => (x(0), (x(1).toFloat, 1)) }\nd2.collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"82e1e01a-d6c5-4b49-bed2-528fcb4e3dec"},{"version":"CommandV1","origId":503877321548170,"guid":"948c4763-d66a-45b2-b54b-51edfab828e7","subtype":"command","commandType":"auto","position":8.0,"command":"val d3 = d2.reduceByKey { case ((num1, count1), (num2, count2)) => (num1 + num2, count1 + count2) }\nd3.collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"da7f133c-8918-4437-9880-0559538103ea"},{"version":"CommandV1","origId":503877321548171,"guid":"5f20313d-edd9-4199-922a-6392fb853782","subtype":"command","commandType":"auto","position":9.0,"command":"val d4 = d3.map { case (key, (num, count)) => (key, num / count) }\nd4.collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0e690b43-6130-4bfc-ac36-fd7ab42d01d5"},{"version":"CommandV1","origId":503877321548172,"guid":"6ef06211-0588-4a66-97e1-ce03dc9189d1","subtype":"command","commandType":"auto","position":10.0,"command":"%md And here's the DataFrame version:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"806a7100-d279-429c-8c6e-387922d9403c"},{"version":"CommandV1","origId":503877321548173,"guid":"3bb18916-8edb-4eb8-8865-f08fb3a1dae6","subtype":"command","commandType":"auto","position":11.0,"command":"import org.apache.spark.sql.functions._\n\nval df = rdd.map(a => (a(0), a(1))).toDF(\"key\", \"value\")\ndf.groupBy(\"key\")\n  .agg(avg(\"value\"))\n  .collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9eedede4-022a-4e77-a102-749f7a7eb112"}],"dashboards":[],"guid":"96ea8c19-5bc3-4d59-b8d2-e021dd02f9ba","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}