{"version":"NotebookV1","origId":503877321548148,"name":"Compute-Average-Python","language":"python","commands":[{"version":"CommandV1","origId":503877321548150,"guid":"2102a283-eb84-451e-940b-72a5cc7a2cfb","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n# DataFrames = less code","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b1c45491-8dde-4fb4-8ded-2d763545aebd"},{"version":"CommandV1","origId":503877321548151,"guid":"adfc12d9-22ee-4a0f-8628-da8cdf88e7c3","subtype":"command","commandType":"auto","position":2.0,"command":"DATA = [\"coffee 10\", \"coffee 20\", \"coffee 32\", \"tea 10\", \"tea 15\", \"tea 29\"]","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2352cb6d-d627-40d6-8fe1-030f142e290e"},{"version":"CommandV1","origId":503877321548152,"guid":"789d979d-8218-4f89-a91d-2217e7bfd307","subtype":"command","commandType":"auto","position":3.0,"command":"rdd = sc.parallelize(DATA).map(lambda s: s.split())","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"877109f3-968f-4be7-9a53-f974ae03d4f5"},{"version":"CommandV1","origId":503877321548153,"guid":"bdf566cc-64f6-4e04-8966-1b0e7465a9d6","subtype":"command","commandType":"auto","position":4.0,"command":"%md Here it is, not broken down:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"56531142-7f86-4ae7-aacc-4a30031b70cf"},{"version":"CommandV1","origId":503877321548154,"guid":"b71a3f75-5af4-454d-81c3-59f0f6b0d06e","subtype":"command","commandType":"auto","position":5.0,"command":"rdd.map(lambda x: (x[0], (float(x[1]), 1))).\\\n    reduceByKey(lambda t1, t2: (t1[0] + t2[0], t1[1] + t2[1])).\\\n    map(lambda t: (t[0], t[1][0] / t[1][1])).\\\n    collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f9fa52c6-17e4-4de5-9d3c-2e3c994d26bf"},{"version":"CommandV1","origId":503877321548155,"guid":"fd5454ed-eb19-425c-9fa5-f1e55d4c4bf4","subtype":"command","commandType":"auto","position":6.0,"command":"%md If you break it down into steps, you can see what's going on.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"82a16569-bfac-45de-9114-68b9a11a65b8"},{"version":"CommandV1","origId":503877321548156,"guid":"d38c49d8-132d-4fe7-b4ca-ede404461e4a","subtype":"command","commandType":"auto","position":7.0,"command":"d2 = rdd.map(lambda x: (x[0], (float(x[1]), 1)))\nd2.collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8010b52a-458c-4bee-b48b-3c098c9af756"},{"version":"CommandV1","origId":503877321548157,"guid":"7d0ebb39-b2a3-4495-b879-6fec2f00cabe","subtype":"command","commandType":"auto","position":8.0,"command":"d3 = d2.reduceByKey(lambda t1, t2: (t1[0] + t2[0], t1[1] + t2[1]))\nd3.collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a64f2495-39a5-451d-8ef8-affdb69dc5d7"},{"version":"CommandV1","origId":503877321548158,"guid":"b03dcd09-7306-4249-9ff8-056b18f47673","subtype":"command","commandType":"auto","position":9.0,"command":"d4 = d3.map(lambda t: (t[0], t[1][0] / t[1][1]))\nd4.collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"52b28633-6452-47c4-84a6-d6110d131daa"},{"version":"CommandV1","origId":503877321548159,"guid":"77e3226e-a791-4681-b37a-2250b4cb355b","subtype":"command","commandType":"auto","position":10.0,"command":"%md And here's the DataFrame version.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9cb16ae2-bf88-4da3-b64f-24bead622622"},{"version":"CommandV1","origId":503877321548160,"guid":"6e73514f-f453-43c8-9d33-eaf400da7d0f","subtype":"command","commandType":"auto","position":11.0,"command":"from pyspark.sql.functions import *\n\ndf = rdd.map(lambda a: (a[0], a[1])).toDF((\"key\", \"value\"))\ndf.groupBy(\"key\").agg(avg(\"value\")).collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"20453c7a-ec01-4be5-a48d-e169d8df5d0f"}],"dashboards":[],"guid":"cd095abc-9830-4a3b-a28d-f84efb4f8831","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}