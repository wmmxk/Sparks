{"version":"NotebookV1","origId":503877321548034,"name":"CatalystTungstenExecution","language":"scala","commands":[{"version":"CommandV1","origId":503877321548036,"guid":"28630246-338c-4fff-91f3-96775d6bcd3c","subtype":"command","commandType":"auto","position":1.0,"command":"%md # Catalyst + Tungsten","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c00f7b8e-05ab-4005-a0e8-214069e4a95b"},{"version":"CommandV1","origId":503877321548037,"guid":"2dd49159-2c04-4000-b1f2-7bcf2d60ea25","subtype":"command","commandType":"auto","position":2.0,"command":"sqlContext.read.text(\"dbfs:/mnt/training/data/tom_sawyer\").collect","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4428a46e-4068-47f3-8097-1611da29e6d5"},{"version":"CommandV1","origId":503877321548038,"guid":"4bb8b2c7-5fcd-40ac-8410-876ec0e30dd5","subtype":"command","commandType":"auto","position":3.0,"command":"sqlContext.read.text(\"dbfs:///mnt/training/data/tom_sawyer\").flatMap(_.getString(0).split(\" \")).toDF(\"word\").collect","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a614e19b-ecac-4328-b307-bf82b4990c9c"},{"version":"CommandV1","origId":503877321548039,"guid":"b12060c6-32c5-4212-8684-2b4e1e2e4d98","subtype":"command","commandType":"auto","position":4.0,"command":"%md ## Optimizations","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ddc6e314-60d6-41f3-9dd0-71e175c1b87e"},{"version":"CommandV1","origId":503877321548040,"guid":"35ccd92a-4801-4a35-8077-2a5e0e200f46","subtype":"command","commandType":"auto","position":5.0,"command":"sqlContext.read.text(\"dbfs:///mnt/training/data/tom_sawyer\").flatMap(_.getString(0).split(\" \")).toDF(\"word\").filter(\"word > 'F'\").filter(\"word > 'H'\").explain(true)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"915fa685-f584-4a61-8d56-484ec740b355"},{"version":"CommandV1","origId":503877321548041,"guid":"85819e63-5cfb-401f-b777-cfa314ba10ea","subtype":"command","commandType":"auto","position":6.0,"command":"sqlContext.read.text(\"dbfs:///mnt/training/data/tom_sawyer\").flatMap(_.getString(0).split(\" \")).toDF(\"word\").select(\"word\").filter(\"word > 'H'\").explain(true)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"665dc66e-9dc3-41e0-b148-50d7461c4255"},{"version":"CommandV1","origId":503877321548042,"guid":"285e9c81-6a81-4d1c-822d-5346d3da7cd9","subtype":"command","commandType":"auto","position":7.0,"command":"sqlContext.read.text(\"dbfs:///mnt/training/data/tom_sawyer\").flatMap(_.getString(0).split(\" \")).toDF(\"word\").filter(\"word > 'F'\").select(\"word\").filter(\"word > 'H'\").explain(true)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b8e55be1-25a6-401d-91b6-cfea8bfd3687"},{"version":"CommandV1","origId":503877321548043,"guid":"fdbcab2f-f774-4dce-a351-5b1627a13ff6","subtype":"command","commandType":"auto","position":8.0,"command":"%md ## Exchanges, Jobs, and Shuffles (Stages)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b8037910-3e7d-470a-b284-23fb9989744e"},{"version":"CommandV1","origId":503877321548044,"guid":"46a99fe4-8166-421e-9abb-5f441a756377","subtype":"command","commandType":"auto","position":9.0,"command":"sqlContext.read.text(\"dbfs:///mnt/training/data/tom_sawyer\").flatMap(_.getString(0).split(\" \")).toDF(\"word\").collect","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2b6daec7-01d8-4dfe-b83e-7321e6968465"},{"version":"CommandV1","origId":503877321548045,"guid":"1abe4a44-02d8-4a47-bdfc-7eee9bfda8cf","subtype":"command","commandType":"auto","position":10.0,"command":"sqlContext.read.text(\"dbfs:///mnt/training/data/tom_sawyer\").flatMap(_.getString(0).split(\" \")).toDF(\"word\").groupBy(\"word\").count.collect","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0b5b1f2b-c138-4a83-bef5-f6487b07af46"},{"version":"CommandV1","origId":503877321548046,"guid":"4f3fa27c-eac4-4a35-8762-fbb9e8e0d2d7","subtype":"command","commandType":"auto","position":11.0,"command":"sqlContext.read.text(\"dbfs:///mnt/training/data/tom_sawyer\").flatMap(_.getString(0).split(\" \")).toDF(\"word\").groupBy(\"word\").count.orderBy($\"count\".desc).collect","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"503ed530-c860-462f-89f5-6604ee2d3c53"},{"version":"CommandV1","origId":503877321548047,"guid":"8ffa77c4-521c-4f20-b222-e0faad23b953","subtype":"command","commandType":"auto","position":12.0,"command":"sqlContext.read.text(\"dbfs:///mnt/training/data/tom_sawyer\").flatMap(_.getString(0).split(\" \")).toDF(\"word\")\n  .groupBy(\"word\").count.withColumnRenamed(\"count\", \"wordOccurrences\").groupBy(\"wordOccurrences\").count.orderBy(\"wordOccurrences\").collect","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"93c7ba11-d442-459c-9705-f1237013a3f0"},{"version":"CommandV1","origId":503877321548048,"guid":"62cd7210-631c-4806-b1f2-412b05d6d2f5","subtype":"command","commandType":"auto","position":13.0,"command":"val df = sqlContext.read.text(\"dbfs:///mnt/training/data/tom_sawyer\").flatMap(_.getString(0).split(\" \")).toDF(\"word\")\ndf.cache\ndf.groupBy(\"word\").count.withColumnRenamed(\"count\", \"wordOccurrences\").groupBy(\"wordOccurrences\").count.orderBy(\"wordOccurrences\").collect","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8ffe8002-5acf-47f3-b4e3-710e43c7fd2a"},{"version":"CommandV1","origId":503877321548049,"guid":"67fff419-8b21-4c7c-b67b-1aa94e629a31","subtype":"command","commandType":"auto","position":14.0,"command":"val df = sqlContext.read.text(\"dbfs:///mnt/training/data/tom_sawyer\")\n\n// Interpret each line as a java.lang.String (using built-in encoder)\nval ds = df.as[String]\n.flatMap(line => line.split(\" \"))               // Split on whitespace\n.filter(line => line != \"\")                     // Filter empty words\n.groupBy(word => word)\n.count()\n\nds.collect","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4f6fa742-cf25-4ed0-aa9e-05f6ed499b15"},{"version":"CommandV1","origId":503877321548050,"guid":"fdc99e1d-5207-4a34-a6dc-6f23f1cf86bb","subtype":"command","commandType":"auto","position":15.0,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b7c2d588-3daf-40f4-a5ff-7134cc4a95be"}],"dashboards":[],"guid":"1c058061-abba-4e80-83ed-843e29dfb507","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}