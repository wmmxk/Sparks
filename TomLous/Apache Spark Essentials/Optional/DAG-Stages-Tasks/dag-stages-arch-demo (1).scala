{"version":"NotebookV1","origId":503877321548095,"name":"dag-stages-arch-demo (1)","language":"scala","commands":[{"version":"CommandV1","origId":503877321548097,"guid":"69d10555-5209-48c4-a786-74eea0686e79","subtype":"command","commandType":"auto","position":1.0,"command":"//Start this demo on a Spark cluster with at least 1 Worker","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bdaadca8-ce9d-44c3-9c7c-0d7078a7f6c6"},{"version":"CommandV1","origId":503877321548098,"guid":"d25d7049-a0a3-499d-9e87-b32c0d6de308","subtype":"command","commandType":"auto","position":2.0,"command":"// Where will the #5 print here? Which JVM's log?\n// Answer: Driver JVM\nval y = 4 + 1\nprintln(y)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ff08d1ff-f3cf-4075-a7f6-f161728d18ea"},{"version":"CommandV1","origId":503877321548099,"guid":"778c3ccc-226e-4ad6-94d7-dc14c9c457f3","subtype":"command","commandType":"auto","position":3.0,"command":"// First, create a Scala array\nval wordList = Array(\"cat\", \"cat\", \"fish\", \"dog\", \"fish\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5e12b6ef-2b24-48fb-9677-7f9b831de66f"},{"version":"CommandV1","origId":503877321548100,"guid":"6be3b5ea-8ef8-4e18-8eb3-9dd9657f8625","subtype":"command","commandType":"auto","position":4.0,"command":"// Now, we'll create an RDD from the Scala array, requesting 1 partition\nval wordsRDD = sc.parallelize(wordList, 1)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6cda29ea-a006-41f1-b022-bbbefcdbf7b4"},{"version":"CommandV1","origId":503877321548101,"guid":"67c2944a-e6c2-469e-9d55-fe872dc98c4e","subtype":"command","commandType":"auto","position":5.0,"command":"// Show # of tasks in UI + expand below\nwordsRDD.count()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cebf2889-4ed6-4e3c-8610-6c1ff27753da"},{"version":"CommandV1","origId":503877321548102,"guid":"0967d144-7765-4efe-9a0f-04de6df7e373","subtype":"command","commandType":"auto","position":6.0,"command":"wordsRDD.partitions.length","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ca60d5fc-5740-4771-ae0e-bceb6ecc3950"},{"version":"CommandV1","origId":503877321548103,"guid":"7124b834-b1f4-4b5f-9732-229f240e16b0","subtype":"command","commandType":"auto","position":7.0,"command":"// Also run this a few times and show that on the Executors UI page, the # of tasks just goes up on 1 Executor (not both)\nwordsRDD.collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"18b5b471-c877-4153-9ae0-c044a6e99188"},{"version":"CommandV1","origId":503877321548104,"guid":"b33192cb-cf71-4fcf-8582-898be7f20551","subtype":"command","commandType":"auto","position":8.0,"command":"//Why won't this print anything?\n// Answer: because there's no action\nwordsRDD.map(c => println(c))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"10c27a55-30e7-4d80-8b08-41fafaea1307"},{"version":"CommandV1","origId":503877321548105,"guid":"b2e437ff-ee0e-4631-9c9b-53289effd9cd","subtype":"command","commandType":"auto","position":9.0,"command":"// Where will this print occur? \n// A: To the logs for the Executors (show students via Spark UI's Executors page)\nwordsRDD.map(c => println(c)).collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3b2afd4c-7c29-4c34-8475-58d842ae970e"},{"version":"CommandV1","origId":503877321548106,"guid":"9371db74-9aa1-4d9b-a75d-2134b064f680","subtype":"command","commandType":"auto","position":10.0,"command":"val wordsRDDWith2Partitions = sc.parallelize(wordList, 2)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8ef0f1a5-c23f-4d4e-8d9e-68cd69d3b1d9"},{"version":"CommandV1","origId":503877321548107,"guid":"b5335ea8-967c-4cdf-9760-3ac2941fa7e2","subtype":"command","commandType":"auto","position":11.0,"command":"wordsRDDWith2Partitions.collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fdb59071-2aa6-46dd-aacd-f07b894c21db"},{"version":"CommandV1","origId":503877321548108,"guid":"32c32d5b-deb8-4868-a59e-bed4e9311ea2","subtype":"command","commandType":"auto","position":12.0,"command":"// How do we check what is in each of the two parititions?\nwordsRDDWith2Partitions.map(c => println(c)).collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"231a7d32-f41f-4ae7-a1ab-ce2e19e6c63e"},{"version":"CommandV1","origId":503877321548109,"guid":"00b2e426-abd3-4473-ac10-5fd40ff3a4a4","subtype":"command","commandType":"auto","position":13.0,"command":"for (p <- wordsRDDWith2Partitions.glom.collect())\n  println(p.toSeq)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b24a2837-23a9-4dd7-9232-67422c49768a"},{"version":"CommandV1","origId":503877321548110,"guid":"ed0bcb6a-399a-4ada-a25f-5e15b80f0e36","subtype":"command","commandType":"auto","position":14.0,"command":"sc","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0f5cb510-b398-4106-bfa8-2fb64453e83b"},{"version":"CommandV1","origId":503877321548111,"guid":"daa631f8-d451-49ce-970b-619f6ee75830","subtype":"command","commandType":"auto","position":15.0,"command":"sc.version","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1e944ba8-83ec-408b-b1d0-86e79e887433"},{"version":"CommandV1","origId":503877321548112,"guid":"bfedbe7c-f3c9-42f3-8645-c21019a15186","subtype":"command","commandType":"auto","position":16.0,"command":"sc.appName","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4efd3352-5c9b-4237-998b-92cd04ed3d8b"},{"version":"CommandV1","origId":503877321548113,"guid":"cc11ec1c-9806-4f99-b33d-3a95aec1a895","subtype":"command","commandType":"auto","position":17.0,"command":"sc.defaultParallelism","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e548dafb-f63c-4bd9-8262-2bc516cf387e"},{"version":"CommandV1","origId":503877321548114,"guid":"fe333677-d323-46e3-8dc6-acd55414010d","subtype":"command","commandType":"auto","position":18.0,"command":"// Notice that this has 1 task per executor core\nval testRDD = sc.parallelize(0 to 100).collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a1cb3653-9e03-4499-ad02-ea419a4176fc"},{"version":"CommandV1","origId":503877321548115,"guid":"b204be3d-f535-4406-a63f-a4f2859de817","subtype":"command","commandType":"auto","position":19.0,"command":"display(dbutils.fs.ls(\"dbfs:///mnt/training/data/tom_sawyer\"))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"419792f2-29fc-47b4-9cf0-0d3c58243af8"},{"version":"CommandV1","origId":503877321548116,"guid":"37c8b5d1-60bb-487c-93c1-dfc774b9bf9e","subtype":"command","commandType":"auto","position":20.0,"command":"// Show how the IO aligns in UI\nsc.textFile(\"dbfs:///mnt/training/data/tom_sawyer\", 2).collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f1f71d80-fc29-4a1c-b53b-e378ce81aef9"},{"version":"CommandV1","origId":503877321548117,"guid":"999d3331-e64d-4e2c-8931-ba4af6268e52","subtype":"command","commandType":"auto","position":21.0,"command":"// What will be the type of ebook below?\nval ebook = sc.textFile(\"dbfs:///mnt/training/data/tom_sawyer\").collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"787bd9eb-709a-45e5-a46f-b09fa909880c"},{"version":"CommandV1","origId":503877321548118,"guid":"fde915f8-954f-41b1-b90b-c774f2b2c4d9","subtype":"command","commandType":"auto","position":22.0,"command":"// Why doesnt this work?\nebook.count()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"96d51440-e854-4ccd-ac36-f05c42e6c74f"},{"version":"CommandV1","origId":503877321548119,"guid":"74f1dbc1-3d8c-4ac8-9377-b4d7382a96a9","subtype":"command","commandType":"auto","position":23.0,"command":"ebook.getClass","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2a85a0a4-aafd-4769-a12b-75e749c275f4"},{"version":"CommandV1","origId":503877321548120,"guid":"f97c4a51-4533-4d2b-8f34-8bd06e22be4d","subtype":"command","commandType":"auto","position":24.0,"command":"val ebookRDD = sc.textFile(\"dbfs:///mnt/training/data/tom_sawyer\", 2)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cc8adf70-2112-469c-9bbb-0024a89ad339"},{"version":"CommandV1","origId":503877321548121,"guid":"ffcf6d17-58e8-491d-9211-df72fbd579d1","subtype":"command","commandType":"auto","position":25.0,"command":"ebookRDD.count()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"63148d83-6726-447a-b591-cd4543daf752"},{"version":"CommandV1","origId":503877321548122,"guid":"2159c596-2a5c-4f92-bf12-80b5996c1c5e","subtype":"command","commandType":"auto","position":26.0,"command":"ebookRDD.partitions.length","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"25815e2e-d9bc-47d4-aba2-628598413048"},{"version":"CommandV1","origId":503877321548123,"guid":"100f62b7-b46a-4505-8956-b98a999b59e0","subtype":"command","commandType":"auto","position":27.0,"command":"ebookRDD.getClass","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dbb2bc2b-d551-43aa-8f46-405a237b42f4"},{"version":"CommandV1","origId":503877321548124,"guid":"1af58bb9-a6bb-427a-bd79-0eb6c3d2dbb2","subtype":"command","commandType":"auto","position":28.0,"command":"ebookRDD","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"10ab57a6-a332-41a3-8251-be4998276e37"},{"version":"CommandV1","origId":503877321548125,"guid":"88805a5c-4d61-466e-bae6-ab26a75d4749","subtype":"command","commandType":"auto","position":29.0,"command":"// It simply counts the number of items in each partition.\nfor ((p, i) <- ebookRDD.glom.collect().zipWithIndex)\n  println(s\"$i: ${p.length} item(s)\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c1137762-856c-4d04-966e-686064028464"},{"version":"CommandV1","origId":503877321548126,"guid":"0ae454a6-1718-42ae-9f00-c3e58f7d8f68","subtype":"command","commandType":"auto","position":30.0,"command":"// Show how this is 2 operations in the UI, STILL 2 tasks! Pipelining...\nsc.textFile(\"dbfs:///mnt/training/data/tom_sawyer\", 2).flatMap(line => line.split(\" \")).collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fd17bac5-d5f7-463b-8bd1-380a899d4f8c"},{"version":"CommandV1","origId":503877321548127,"guid":"c0d52a93-ecd4-4e34-8d42-c81f6d44a6c4","subtype":"command","commandType":"auto","position":31.0,"command":"sc.textFile(\"dbfs:///mnt/training/data/tom_sawyer\", 2).flatMap(line => line.split(\" \")).map(word => (word, 1)).collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"639c9b37-7a12-471a-b1cc-ec2ed6110611"},{"version":"CommandV1","origId":503877321548128,"guid":"c9a57eea-81b1-4c5b-b398-342b9be06151","subtype":"command","commandType":"auto","position":32.0,"command":"sc.textFile(\"dbfs:///mnt/training/data/tom_sawyer\", 2).flatMap(line => line.split(\" \")).map(word => (word, 1)).reduceByKey((x, y) => x + y).collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"83efc945-e4d0-4013-ac4e-75372500b17a"},{"version":"CommandV1","origId":503877321548129,"guid":"8645cf10-9742-4a23-9c18-7768e0c0a449","subtype":"command","commandType":"auto","position":33.0,"command":"// Notice stage 2 has 4 tasks now\nsc.textFile(\"dbfs:///mnt/training/data/tom_sawyer\", 2).flatMap { line => line.split(\" \") }.map { word => (word, 1) }.reduceByKey((x, y) => x + y, 4).collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"be39692d-6177-40ce-bd01-a8e3cb588557"},{"version":"CommandV1","origId":503877321548130,"guid":"724e5628-a7bc-4d91-878e-197fc77ebffc","subtype":"command","commandType":"auto","position":34.0,"command":"//why doesnt this show up?\nval cachedBookRDD = sc.textFile(\"dbfs:///mnt/training/data/tom_sawyer\", 2).cache()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"88cba95b-8307-457e-9d99-1bf8305e4baf"},{"version":"CommandV1","origId":503877321548131,"guid":"86811b39-a5bb-481e-9f5a-fc88ba6342f5","subtype":"command","commandType":"auto","position":35.0,"command":"cachedBookRDD.setName(\"My Cached Book\") ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"15f74187-1c75-4b07-8754-7f8985407bee"},{"version":"CommandV1","origId":503877321548132,"guid":"4da84791-fc9f-44ef-b3c9-26c8615a17d3","subtype":"command","commandType":"auto","position":36.0,"command":"// Run this twice to show speed increase\n// Show size in memory of RDD\ncachedBookRDD.count()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5eb45d3a-aa6a-4854-a65d-7ecadefa3b9a"},{"version":"CommandV1","origId":503877321548133,"guid":"759e5929-4430-4b32-82fb-23245ddab0b5","subtype":"command","commandType":"auto","position":37.0,"command":"cachedBookRDD.unpersist()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0dbb51aa-e0a2-472a-b41d-bdb3b8cb2f26"},{"version":"CommandV1","origId":503877321548134,"guid":"e8539a03-8277-43ea-91d1-f09a5d3ede2b","subtype":"command","commandType":"auto","position":38.0,"command":"//why doesnt this show up?\nimport org.apache.spark.storage.StorageLevel._\n\nval cachedBookSerializedRDD = sc.textFile(\"dbfs:///mnt/training/data/tom_sawyer\", 2).persist(MEMORY_ONLY_SER)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"082ffb33-f87a-4eff-b4d6-c7cdff6c04b8"},{"version":"CommandV1","origId":503877321548135,"guid":"740f61e9-d245-431c-b06d-945188c0e36e","subtype":"command","commandType":"auto","position":39.0,"command":"cachedBookSerializedRDD.setName(\"My Serialized Cached Book\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3cedbd9a-6b0a-46c3-b00f-6fd9745c1794"},{"version":"CommandV1","origId":503877321548136,"guid":"4dd46c49-c457-419a-a9e9-1641102005aa","subtype":"command","commandType":"auto","position":40.0,"command":"cachedBookSerializedRDD.count()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"61273df5-c6d9-439a-b493-3d961de35383"},{"version":"CommandV1","origId":503877321548137,"guid":"aed4635b-1dcb-4c70-80b8-0c9732e7abb0","subtype":"command","commandType":"auto","position":41.0,"command":"// Show green cache dot in UI\nsc.textFile(\"dbfs:///mnt/training/data/tom_sawyer\", 2).cache().flatMap(line => line.split(\" \")).map(word => (word, 1)).reduceByKey((x, y) => x + y, 4).collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d01a2316-f37e-4cee-92b9-2a5df04aa5f8"},{"version":"CommandV1","origId":503877321548138,"guid":"1c8d3a99-5534-4504-9d7b-337e8a24d0c2","subtype":"command","commandType":"auto","position":42.0,"command":"val tempRDD = sc.textFile(\"dbfs:///mnt/training/data/tom_sawyer\", 2).repartition(4)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2e996b93-5c6d-4fd8-b070-9015d5563429"},{"version":"CommandV1","origId":503877321548139,"guid":"0e7b791f-df59-4d05-a677-73a9d352117d","subtype":"command","commandType":"auto","position":43.0,"command":"tempRDD.partitions.length","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f45af06d-3bba-458c-8a75-a788d51d5640"},{"version":"CommandV1","origId":503877321548140,"guid":"fee61e78-3338-4055-8dd7-c9d1e9dc3dcb","subtype":"command","commandType":"auto","position":44.0,"command":"// It simply counts the number of items in each partition.\nfor ((p, i) <- tempRDD.glom.collect().zipWithIndex)\n  println(s\"$i: ${p.length} item(s)\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e4037b4b-ceec-4443-9bca-bada51c42a1b"},{"version":"CommandV1","origId":503877321548141,"guid":"cdc6f445-0dd7-476e-b387-9b57231dcef3","subtype":"command","commandType":"auto","position":45.0,"command":"sc.textFile(\"dbfs:///mnt/training/data/tom_sawyer\", 2).repartition(4).cache().flatMap(line => line.split(\" \")).map(word => (word, 1)).reduceByKey((x, y) => x + y, 4).collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d160535c-49b8-49a8-a4f6-a0845acffcb9"},{"version":"CommandV1","origId":503877321548142,"guid":"c9b34429-7ce3-4959-a3ec-7fab1b021405","subtype":"command","commandType":"auto","position":46.0,"command":"val xRDD = sc.textFile(\"dbfs:///mnt/training/data/tom_sawyer\").repartition(4).cache()\n\nxRDD.flatMap(line => line.split(\" \")).map(word => (word, 1)).reduceByKey((x, y) => x + y, 4).collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"30f8e86c-a196-4f9b-9aa3-1661dd4a9e08"},{"version":"CommandV1","origId":503877321548143,"guid":"494477a3-f4b1-472d-b91a-4010a04d4735","subtype":"command","commandType":"auto","position":47.0,"command":"// Show how this lets you skip the earlier Stage in UI\n// Change the word from Hadoop to another word like Tom\nxRDD.filter(line => line.contains(\"Tom\")).count()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f7ab025d-aeca-4c45-b296-e9531d490778"},{"version":"CommandV1","origId":503877321548144,"guid":"2caa6519-6f26-4f8e-aa52-4a254d77fd89","subtype":"command","commandType":"auto","position":48.0,"command":"val myRDD = xRDD.flatMap(line => line.split(\" \")).map(word => (word, 1)).reduceByKey((x, y) => x + y, 4).collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8ffdacd7-1644-482d-8b65-9a12901966e4"},{"version":"CommandV1","origId":503877321548145,"guid":"6e2c0597-bbda-4674-8a74-cbf82cff80c3","subtype":"command","commandType":"auto","position":49.0,"command":"val myRDD = xRDD.flatMap(line => line.split(\" \")).map(word => (word, 1)).reduceByKey((x, y) => x + y, 4).sample(false, 0.01, 42).collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"90e2e40f-cee9-4df5-9c8b-88e5a2901689"}],"dashboards":[],"guid":"a15990cd-d941-4f42-b5dc-b36de4239f75","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}