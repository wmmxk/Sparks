{"version":"NotebookV1","origId":503877321548051,"name":"dag-stages-arch-demo","language":"python","commands":[{"version":"CommandV1","origId":503877321548053,"guid":"bb9d2469-0245-4760-84c3-ad1aa16c614c","subtype":"command","commandType":"auto","position":1.0,"command":"# First, create a Python list\nwordList = [\"doug\", \"jon\", \"sameer\", \"eliano\", \"richard\"]","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8437666a-5352-4176-a2dc-6eff74b7ea22"},{"version":"CommandV1","origId":503877321548054,"guid":"97814715-fcb0-4609-b8e5-64dc4b7bc485","subtype":"command","commandType":"auto","position":2.0,"command":"# Now, we'll create an RDD from the Python list with 4 partitions\nwordsRDD = sc.parallelize(wordList, 4)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"64c567b7-25af-4b91-8dc1-02b36fa01d28"},{"version":"CommandV1","origId":503877321548055,"guid":"ce195047-8780-4801-a894-5bdf2758e61d","subtype":"command","commandType":"auto","position":3.0,"command":"# Why won't this print anything?\ndef println(value):\n   print value\n    \nwordsRDD.map(println)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9e59c0dc-46c0-49bc-a0e8-7f38bc4991cc"},{"version":"CommandV1","origId":503877321548056,"guid":"09cd7c71-7866-4641-a319-9df0ac5a9f00","subtype":"command","commandType":"auto","position":4.0,"command":"# This will print something... but where?\nwordsRDD.map(println).collect()\n# Let's look in (executor) logs","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0277755c-36ee-4079-9597-cbf68864e684"},{"version":"CommandV1","origId":503877321548057,"guid":"d1ea4b28-e222-41a0-a15c-f1c0caa7e972","subtype":"command","commandType":"auto","position":5.0,"command":"# Now, we'll create an RDD from the array, requesting 6 partitions\nwordsRDD = sc.parallelize(wordList, 6)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1dfb8f25-d181-474d-97dd-60dfeaac90d2"},{"version":"CommandV1","origId":503877321548058,"guid":"64fa3480-1770-4929-8e5c-6f02cda55dcf","subtype":"command","commandType":"auto","position":6.0,"command":"wordsRDD.collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"946a88c4-53ca-4f1c-a8c3-33f30e3bac7c"},{"version":"CommandV1","origId":503877321548059,"guid":"40c6ee57-7f66-4435-b884-c2bdced5416b","subtype":"command","commandType":"auto","position":7.0,"command":"sc","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"23ba5525-ebe0-40fb-a76e-a677a8406a4a"},{"version":"CommandV1","origId":503877321548060,"guid":"0b329b00-b670-4126-89e9-33375f1e1031","subtype":"command","commandType":"auto","position":8.0,"command":"sc.version","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d73ffb51-a0d2-49ba-b5f6-d8125883eab6"},{"version":"CommandV1","origId":503877321548061,"guid":"9747ca2b-e321-4608-92e6-e4533d46d316","subtype":"command","commandType":"auto","position":9.0,"command":"sc.appName","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6f704e0a-4bdb-475e-b6d0-8714e45d1675"},{"version":"CommandV1","origId":503877321548062,"guid":"19738475-9c50-4ea8-a6c4-b1834c20f64d","subtype":"command","commandType":"auto","position":10.0,"command":"sc.defaultParallelism","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d4f8b9d9-0b24-412f-8049-33a8f961df8e"},{"version":"CommandV1","origId":503877321548063,"guid":"e0d7762e-29f6-43b7-81ad-abbe99ea29a9","subtype":"command","commandType":"auto","position":11.0,"command":"datapath = \"dbfs:/mnt/training/data/tom_sawyer\" # https://www.gutenberg.org/ebooks/74","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f28f9819-5f8d-4911-9986-83e18a2cebca"},{"version":"CommandV1","origId":503877321548064,"guid":"dafcfd68-fe7b-4dbb-8ae6-2f66f263ba70","subtype":"command","commandType":"auto","position":12.0,"command":"sc.textFile(datapath, 2).collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"112cced0-b429-412e-8751-bfa2ecf77cbf"},{"version":"CommandV1","origId":503877321548065,"guid":"849d791e-680b-4ac8-aee8-2ba88a1979d9","subtype":"command","commandType":"auto","position":13.0,"command":"# Note, collect does not return an RDD (it returns an Array)\nebook = sc.textFile(datapath, 2).collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5944d592-bf46-4a55-b7e6-845d66d43bab"},{"version":"CommandV1","origId":503877321548066,"guid":"2692c3a4-9328-4a98-bf97-cf5bf03c2288","subtype":"command","commandType":"auto","position":14.0,"command":"# Why doesnt this work?\nebook.count()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bc2a2cbe-8dfb-4e13-9c51-63a069fd9a50"},{"version":"CommandV1","origId":503877321548067,"guid":"2c3cd816-effe-4baa-a931-7e3d42f9901c","subtype":"command","commandType":"auto","position":15.0,"command":"print 'type of ebook: {0}'.format(type(ebook))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a2c2a4f8-3441-462b-ba79-970db7bfc75a"},{"version":"CommandV1","origId":503877321548068,"guid":"4a69b961-afe4-4509-ab2a-f578cb07812f","subtype":"command","commandType":"auto","position":16.0,"command":"# Why doesnt this show up in the UI\nebookRDD = sc.textFile(datapath, 2)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2a5125d3-dde3-4773-9754-7d8219e42a29"},{"version":"CommandV1","origId":503877321548069,"guid":"5750f2fb-0d29-498d-a9bf-8ba6e372c76d","subtype":"command","commandType":"auto","position":17.0,"command":"ebookRDD.count()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6a7af84d-51dc-4bd1-8b8e-b3bdce2f8b49"},{"version":"CommandV1","origId":503877321548070,"guid":"2b891a91-bf71-4e5d-ac20-4bf09e68799d","subtype":"command","commandType":"auto","position":18.0,"command":"ebookRDD.getNumPartitions()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d6ec4c1e-7f8b-4042-84b7-d301df2476ff"},{"version":"CommandV1","origId":503877321548071,"guid":"2d6604d6-6aa4-4479-8fa5-09ac5a3dadbe","subtype":"command","commandType":"auto","position":19.0,"command":"print 'type of ebookRDD: {0}'.format(type(ebookRDD))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fab06ac2-7981-41cf-b825-11def7fd4f1f"},{"version":"CommandV1","origId":503877321548072,"guid":"280ca42f-07a9-4171-8968-d2888bcac327","subtype":"command","commandType":"auto","position":20.0,"command":"ebookRDD","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"591e04b6-a9e3-4166-a5ee-2e1f82e08241"},{"version":"CommandV1","origId":503877321548073,"guid":"9a057088-0140-4ade-89c5-329fcba085f9","subtype":"command","commandType":"auto","position":21.0,"command":"# Let's use RDD.glom to look at the distribution of data in our partitions\n\n# What does glom do? Replaces each partition in the RDD with a single container that contains all of the partition's previous items\n# http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.glom\n\nglomDemo = sc.parallelize([1,2,3,4,5,6,7,8,9], 3)\nglomDemo.glom().collect()\n\n# How does it work? This is a good one to guess about, and then check the source","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8510026b-c3d0-41c5-9f4d-0b2fc72438d0"},{"version":"CommandV1","origId":503877321548074,"guid":"72aa3b83-2534-4dc6-8bbe-0db79b32cb4f","subtype":"command","commandType":"auto","position":22.0,"command":"ebookRDD.glom().collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2c40e8b6-30d3-45e6-b37a-d32e40dafe92"},{"version":"CommandV1","origId":503877321548075,"guid":"8d1533de-2801-46f3-8891-5fc931b29ecc","subtype":"command","commandType":"auto","position":23.0,"command":"# Count the number of items in each partition.\nfor (p, i) in ebookRDD.glom().zipWithIndex().collect():\n  print '%d: %d items(s)' % (i, len(p))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"05d7c3ed-4d3f-4353-b8f6-6a3080433f7d"},{"version":"CommandV1","origId":503877321548076,"guid":"423dd125-7baf-4154-9028-cdcca40d614d","subtype":"command","commandType":"auto","position":24.0,"command":"sc.textFile(datapath, 2).flatMap(lambda x: x.split(' ')).collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d12ea984-b83e-4ac2-8817-1b4207dc0366"},{"version":"CommandV1","origId":503877321548077,"guid":"3cf4fba0-a1c5-411f-8cf8-c8eb65baf6f1","subtype":"command","commandType":"auto","position":25.0,"command":"sc.textFile(datapath, 2).flatMap(lambda x: x.split(' ')).map(lambda s: (s, 1)).collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d36b46b3-86b1-4d77-8d57-9500a28b4e3d"},{"version":"CommandV1","origId":503877321548078,"guid":"1c7b4642-5006-4b43-b1c5-5b3bce5f3e59","subtype":"command","commandType":"auto","position":26.0,"command":"sc.textFile(datapath, 2).flatMap(lambda x: x.split(' ')).map(lambda s: (s, 1)).reduceByKey(lambda x, y: x + y).collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"63e39f29-976f-44c9-b35e-65e371a61fbc"},{"version":"CommandV1","origId":503877321548079,"guid":"f72f4631-4f9d-45fa-b5d2-dd7ffa4beab3","subtype":"command","commandType":"auto","position":27.0,"command":"# why doesnt this show up?\ncachedBookRDD = sc.textFile(datapath, 2).cache()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c5b8f955-f739-40ba-8256-51b2ebadd2c1"},{"version":"CommandV1","origId":503877321548080,"guid":"f15acfe8-4ac8-46a5-ace0-e87b091b846e","subtype":"command","commandType":"auto","position":28.0,"command":"cachedBookRDD.setName(\"My Cached Book\") ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9e41274e-132f-477a-a978-2c932e7c3521"},{"version":"CommandV1","origId":503877321548081,"guid":"3b7cb6de-c06c-43d3-98dc-099037b5a74e","subtype":"command","commandType":"auto","position":29.0,"command":"cachedBookRDD.count()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"18bcb8af-91fc-43b8-bece-3e43a5a2ce0c"},{"version":"CommandV1","origId":503877321548082,"guid":"0af069c6-84d1-47c6-a60d-3367f1809179","subtype":"command","commandType":"auto","position":30.0,"command":"cachedBookRDD.unpersist()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a6a4c5b8-3716-4d2f-8ac0-24ff9ae195b4"},{"version":"CommandV1","origId":503877321548083,"guid":"2e987698-d55c-4974-95ab-a25638b85131","subtype":"command","commandType":"auto","position":31.0,"command":"from pyspark.storagelevel import StorageLevel\ncachedBookSerializedRDD = sc.textFile(datapath, 2).persist(StorageLevel.MEMORY_ONLY_SER) #same thing as above, since we're using Python","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e1eadcaa-a968-43b8-98d9-c1110567e4b1"},{"version":"CommandV1","origId":503877321548084,"guid":"651fbdad-57db-43e1-9f43-b2397543543a","subtype":"command","commandType":"auto","position":32.0,"command":"cachedBookSerializedRDD.setName(\"My Serialized Cached Book\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"044673be-3a9e-4f49-928e-cfd90f6c8d51"},{"version":"CommandV1","origId":503877321548085,"guid":"9fcabe82-7753-471c-8b6c-bb6ee70b31f6","subtype":"command","commandType":"auto","position":33.0,"command":"cachedBookSerializedRDD.count()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2aefb23b-a3cc-4d84-92de-823e82fa903c"},{"version":"CommandV1","origId":503877321548086,"guid":"4c1797f3-76c1-4cdb-9319-5376dbaecf76","subtype":"command","commandType":"auto","position":34.0,"command":"sc.textFile(datapath, 2).flatMap(lambda x: x.split(' ')).map(lambda s: (s, 1)).reduceByKey(lambda x, y: x + y).collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1e3643a1-d4ae-40de-a5b6-ceb2b8f235e8"},{"version":"CommandV1","origId":503877321548087,"guid":"ac3eb0f8-6ac2-43f0-8d6c-c94c8bb2a13e","subtype":"command","commandType":"auto","position":35.0,"command":"tempRDD = sc.textFile(datapath, 2).repartition(4)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1fea6246-8b4b-4ae8-b980-5368d6c11ac1"},{"version":"CommandV1","origId":503877321548088,"guid":"3810f085-cb6e-4057-9580-38a36a8f63ca","subtype":"command","commandType":"auto","position":36.0,"command":"tempRDD.getNumPartitions()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2e1aab63-77db-4592-a78f-425fd4cb6860"},{"version":"CommandV1","origId":503877321548089,"guid":"0c42caa4-9515-46ee-bd75-c3ec5eef1682","subtype":"command","commandType":"auto","position":37.0,"command":"# It simply counts the number of items in each partition.\nfor (p, i) in tempRDD.glom().zipWithIndex().collect():\n  print '%d: %d items(s)' % (i, len(p))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"14cd1aec-053d-4dd9-a613-ffd89e7ee780"},{"version":"CommandV1","origId":503877321548090,"guid":"abf18ad9-8403-439c-a20f-302c3636721a","subtype":"command","commandType":"auto","position":38.0,"command":"sc.textFile(datapath, 2).repartition(12).cache().flatMap(lambda x: x.split(' ')).map(lambda s: (s, 1)).reduceByKey(lambda x, y: x + y).collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"190b101e-649e-460b-8511-d12641c09ddd"},{"version":"CommandV1","origId":503877321548091,"guid":"84680298-78b3-419d-ae99-2346f7da9714","subtype":"command","commandType":"auto","position":39.0,"command":"sc.textFile(datapath, 2).repartition(4).cache().flatMap(lambda x: x.split(' ')).map(lambda s: (s, 1)).reduceByKey(lambda x, y: x + y).collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"00df987a-10af-4ccb-b6ae-7f4c6870ec1f"},{"version":"CommandV1","origId":503877321548092,"guid":"8cd5f4c5-bc5e-4733-8a23-06dee9077612","subtype":"command","commandType":"auto","position":40.0,"command":"myRDD = sc.textFile(datapath, 2).repartition(12).cache().flatMap(lambda x: x.split(' ')).map(lambda s: (s, 1)).reduceByKey(lambda x, y: x + y, numPartitions=8)\nmyRDD.collect()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"20285865-2f73-4452-86e8-a5edb35c93c9"},{"version":"CommandV1","origId":503877321548093,"guid":"d023ab8f-ef77-412b-994c-38cd458ea239","subtype":"command","commandType":"auto","position":41.0,"command":"myRDD.getNumPartitions()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5512985c-8757-4bd7-ba01-fa6b4dc34a4f"},{"version":"CommandV1","origId":503877321548094,"guid":"d71f1ed4-7ea9-433d-915f-67b9cf9f7672","subtype":"command","commandType":"auto","position":42.0,"command":"myRDD.count() \n# this job uses data that is downstream from a shuffle we recently did -- Spark should use those shuffle output files to take a shortcut\n# let's look in the UI for skipped stages","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bcd1d5d1-addc-44a6-aee6-9b7cfede987f"}],"dashboards":[],"guid":"872a7e7f-cbe0-49e9-bf60-333c2b67512a","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}