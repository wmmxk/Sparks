{"version":"NotebookV1","origId":503877321547978,"name":"Lab","language":"python","commands":[{"version":"CommandV1","origId":503877321547980,"guid":"9daea5dc-cb2c-42bd-ae82-c672008a7331","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n# Spark Streaming Lab (Python)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"482e4194-c4ab-4d85-b020-4ba518b9cd2b"},{"version":"CommandV1","origId":503877321547981,"guid":"8891755b-06f8-4262-9397-9f94a81f4019","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n## Setup\n\nThis first section is largely just setup. If you want to play around with the configuration constants, feel free to do so. But leave the imports and the `assert` alone.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0161d3ea-a3ce-471d-9420-aabfc8532ce9"},{"version":"CommandV1","origId":503877321547982,"guid":"b9ea23eb-9818-4efb-9200-248561fad64b","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n## WARNING! THIS LAB DOESN'T WORK YET!","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"41495996-f9f7-41fc-82e4-6cda58487028"},{"version":"CommandV1","origId":503877321547983,"guid":"7f6e9ae1-6ce9-4d45-9a5e-02c19ce95130","subtype":"command","commandType":"auto","position":4.0,"command":"from pyspark import SparkContext\nfrom pyspark.streaming import StreamingContext\nimport random\n\nWORDS_FILE = \"dbfs:/home/training/streaming/randomized-word-game.txt\"\nTABLE_NAME = \"words_{0}\".format(random.randint(1, 1000))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3a4bac36-ac71-4836-9986-1204628aa083"},{"version":"CommandV1","origId":503877321547984,"guid":"2f4df9e7-8319-4486-a0b7-3f0102fb19cd","subtype":"command","commandType":"auto","position":5.0,"command":"ssc = StreamingContext(sc, 1)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5ef607ab-d37d-44ae-b060-dd4e1060cba7"},{"version":"CommandV1","origId":503877321547985,"guid":"fd29f65d-eb82-4d1d-b5e3-65cdd4c802b9","subtype":"command","commandType":"auto","position":6.0,"command":"stream = ssc.textFileStream('dbfs:/home/training/streaming')\nword_count_stream = stream.map(lambda word: (word, 1)).reduceByKey(lambda m, n: m + n)\nword_count_stream.foreachRDD(lambda rdd: rdd.toDF(\"word, count\").write.mode(\"append\").saveAsTable(TABLE_NAME))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c7679a9a-c156-445d-9aa9-001f64696175"},{"version":"CommandV1","origId":503877321547986,"guid":"926d8e98-20eb-49cc-af79-3570bdf68ed3","subtype":"command","commandType":"auto","position":7.0,"command":"print(TABLE_NAME)\nssc.start()\nssc.awaitTermination()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cec6d006-5c35-4cd1-8d88-a255f81c4daf"},{"version":"CommandV1","origId":503877321547987,"guid":"b8cf9845-a355-4a49-8b64-56abce813a86","subtype":"command","commandType":"auto","position":8.0,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b0a4d00f-0073-4bfd-a12b-582c5a1fc4e0"}],"dashboards":[],"guid":"8eca725d-3daf-47d4-8c85-43b3f8aa903c","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}