{"version":"NotebookV1","origId":503877321547873,"name":"Lab","language":"python","commands":[{"version":"CommandV1","origId":503877321547875,"guid":"56e07d76-918f-454f-a090-43922371eb30","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n# Log File Streaming Lab\n\nIn this lab, we'll be reading (fake) log data from a stream.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"254c9009-8124-4ed4-95f1-38dcc0034c06"},{"version":"CommandV1","origId":503877321547876,"guid":"c0545065-11bb-403e-9b8e-f52fb94fe489","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n\n## WARNING\n\nThis lab does not currently work. There are, apparently, issues with the Python streaming library.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"72aa4a49-a109-4f96-a618-22782a6bde2a"},{"version":"CommandV1","origId":503877321547877,"guid":"80b9ffae-09b2-4eb4-a701-e9ba71559f39","subtype":"command","commandType":"auto","position":3.0,"command":"from pyspark import *\nfrom pyspark.streaming import *\nfrom pyspark.sql import *\nimport random\nfrom datetime import datetime\n\ndef now_as_millis():\n  import time\n  import calendar\n  return calendar.timegm(time.gmtime())\n\nassert int(sc.version.replace(\".\", \"\")) >= 140, \"Spark 1.4.0 or greater is required.\"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cd761fed-25b8-467b-9a0b-be63c59b278c"},{"version":"CommandV1","origId":503877321547878,"guid":"b1d88517-601c-4e1f-a28a-c4e6d2f81279","subtype":"command","commandType":"auto","position":4.0,"command":"BATCH_INTERVAL_SECONDS = 15\nOUTPUT_DIR = \"dbfs:/tmp/streaming/logs/{0}\".format(random.randint(1, 1000))\nOUTPUT_FILE = \"{0}/{1}.parquet\".format(OUTPUT_DIR, now_ms)\nCHECKPOINT_DIR = \"{0}/checkpoint\".format(OUTPUT_DIR)\n\nprint \"Using: Batch interval of {0} second(s)\".format(BATCH_INTERVAL_SECONDS)\nprint '       Output directory: \"{0}\"'.format(OUTPUT_DIR)\nprint '       Output file:      \"{0}\"'.format(OUTPUT_FILE)\nprint '       Checkpoint dir:   \"{0}\"'.format(CHECKPOINT_DIR)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8848160b-37ff-4021-a051-1bf67cbd0c0a"},{"version":"CommandV1","origId":503877321547879,"guid":"79801b51-01fa-4dde-ad31-b1731774b6f0","subtype":"command","commandType":"auto","position":5.0,"command":"%md\nWe need to pull in some configuration data.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b38a532d-c1e1-4403-a428-010dcde8db1f"},{"version":"CommandV1","origId":503877321547880,"guid":"f9d3f2c4-49c6-4e1c-89cb-70ec26ba4a8e","subtype":"command","commandType":"auto","position":6.0,"command":"%run \"/Labs/streaming/lab03/Python/Configuration\"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0ccdc45b-d6cc-4c97-b22d-bb1dc5ac1670"},{"version":"CommandV1","origId":503877321547881,"guid":"ce5a5b17-af46-4f38-a4a9-694bd2558d6e","subtype":"command","commandType":"auto","position":7.0,"command":"%md \n## Create our Streaming Process\n\nWe're going to connect to a TCP server that serves log messages, one per line. We'll read the messages and write them to a Parquet file.\n\nWe're going to be using a complicated-looking regular expression to take each log message apart:\n\n```\n^\\[(.*)\\]\\s+\\(([^)]+)\\)\\s+(.*)$\n```","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c1e93780-c824-4dcd-851e-97c05d00adb1"},{"version":"CommandV1","origId":503877321547882,"guid":"31a119e2-766c-4fc5-9066-cb10fd65f6c3","subtype":"command","commandType":"auto","position":8.0,"command":"%md\nThe following class contains the code for our stream reader.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e830afd7-f5df-4027-97a0-865f7fac5324"},{"version":"CommandV1","origId":503877321547883,"guid":"c96d8887-461c-494b-9d12-fafee55b539c","subtype":"command","commandType":"auto","position":9.0,"command":"import re\nfrom collections import namedtuple\n\nclass Runner(object):\n\n  def __init__(self):\n    self._ssc = None\n    \n  def stop(self):\n    \"\"\"\n    Stop the streaming context.\n    \"\"\"\n    if self._ssc:\n      self._ssc.stop(stopSparkContext=False, stopGraceFully=True)\n      self._ssc = None\n      print \"Stopped active streaming context.\"\n  \n  def start(self):\n    \"\"\"\n    Start the streaming context\n    \"\"\"\n    # NOTE: StreamingContext.getOrCreate() exists in the Python API, but it currently\n    # throws errors.\n    #self._ssc = StreamingContext.getOrCreate(CHECKPOINT_DIR, Runner._create_streaming_context)\n    self._ssc = Runner._create_streaming_context()\n    print \"Starting {0}\".format(self._ssc)\n    self._ssc.start()\n    print \"Started streaming context.\"\n  \n  def restart(self):\n    \"\"\"\n    Restart the streaming context.\n    \"\"\"\n    self.stop()\n    self.start()\n   \n  @classmethod\n  def _create_streaming_context(cls):\n    LogMessage = namedtuple('LogMessage', ['message_type', 'timestamp', 'message'])\n\n    LOG_LINE_PATTERN = re.compile(r'^\\[(.*)\\]\\s+\\(([^)]+)\\)\\s+(.*)$')\n    TIMESTAMP_FORMAT = '%Y/%m/%d %H:%M:%S.%f'\n    \n    ssc = StreamingContext(sc, BATCH_INTERVAL_SECONDS)\n    ds = ssc.socketTextStream(LOG_SERVER_HOST, LOG_SERVER_PORT)\n\n    # What we're getting is a stream of log lines. As each RDD is created by\n    # Spark Streaming, have the stream create a new RDD that extracts just\n    # the error messages, dropping the rest.\n    def parse_log_line(line):\n      log_message = None\n      try:\n        m = LOG_LINE_PATTERN.search(line)\n        if m:\n          timestamp = datetime.strptime(TIMESTAMP_FORMAT, m.group(1))\n          log_message = LogMessage(m.group(2), timestamp, m.group(3))\n      except:\n        pass\n\n      return log_message\n\n    #keep_logs_stream = ds.map(parse_log_line).filter(lambda line: line is not None)\n\n    # Now, each RDD created by the stream will be converted to something\n    # we can save to a persistent store that can easily be read, later,\n    # into a DataFrame.\n    def save_rdd(rdd):\n      print \"*** processing rdd. rdd.isEmpty={0}\".format(rdd.isEmpty())\n      #if not rdd.isEmpty():\n        #df = sqlContext.createDataFrame(rdd)\n        #df.write.mode(\"append\").parquet(OUTPUT_FILE)\n      rdd.saveAsTextFile(\"{0}-{1}\".format(OUTPUT_DIR, now_as_millis()))\n\n    #keep_logs_stream.foreachRDD(save_rdd)\n    ds.foreachRDD(save_rdd)\n\n    print \"--- ssc={0}\".format(ssc)\n    return ssc  ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8bdbe480-0e47-44c6-b7c4-6f52f332fbaa"},{"version":"CommandV1","origId":503877321547884,"guid":"dd16b0a3-277a-42c4-a725-ce9a6cae484b","subtype":"command","commandType":"auto","position":10.0,"command":"dbutils.fs.rm(OUTPUT_DIR, recurse=True)\ndbutils.fs.mkdirs(OUTPUT_DIR)\nrunner = Runner()\nrunner.stop()\nrunner.restart()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3f48cc34-cc0b-4976-9216-f65b1d8aab6b"},{"version":"CommandV1","origId":503877321547885,"guid":"bf5a5bc7-e005-4364-9a81-c6f47c5c8bb5","subtype":"command","commandType":"auto","position":11.0,"command":"# Is there anything in the output directory?\ndisplay( dbutils.fs.ls(OUTPUT_DIR) )","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"10fb5d20-9089-42d0-b1ba-e8347e2374b6"},{"version":"CommandV1","origId":503877321547886,"guid":"8bd8bddf-8c7e-43a9-a97c-aa474bd3ff7d","subtype":"command","commandType":"auto","position":12.0,"command":"%md\nLet the stream run for awhile. Then, execute the following cell to stop the stream.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9c7e3948-5eef-4098-8562-5edd0f0debc4"},{"version":"CommandV1","origId":503877321547887,"guid":"f5d3409e-9708-49c3-a0c4-62d3ab11425e","subtype":"command","commandType":"auto","position":13.0,"command":"runner.stop()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7cd8009e-d197-42d2-9f77-661a5a219b87"},{"version":"CommandV1","origId":503877321547888,"guid":"455bd9d4-b74a-499d-92d6-6855b7dba2a5","subtype":"command","commandType":"auto","position":14.0,"command":"%md Okay, now let's take a look at what we have in the Parquet file. **NOTE**: This next command may fail periodically if the stream is still running.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d43e4b76-c042-4218-bfd2-b6e65daa5f02"},{"version":"CommandV1","origId":503877321547889,"guid":"b1ad2fa8-733d-47c8-8c32-9053c81a4d3f","subtype":"command","commandType":"auto","position":15.0,"command":"val df = sqlContext.read.parquet(OUTPUT_FILE)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"41f49a52-70c3-4b37-8316-bc9e8f393c58"},{"version":"CommandV1","origId":503877321547890,"guid":"1ea59f8d-6366-488d-966d-f44edf718f9c","subtype":"command","commandType":"auto","position":16.0,"command":"%md How many messages did we pull down?","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7719270c-4cb4-41fb-94d5-0a29b8e76db6"},{"version":"CommandV1","origId":503877321547891,"guid":"72ae18c2-42d8-4434-8e9b-2865fca22604","subtype":"command","commandType":"auto","position":17.0,"command":"df.count","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"906a53f3-1dab-4696-9191-1ecdeffaac8c"},{"version":"CommandV1","origId":503877321547892,"guid":"a4c470fd-4214-4027-b129-bf0611dff4a9","subtype":"command","commandType":"auto","position":18.0,"command":"display(df)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6d72c46e-5edd-453e-adb5-db193cc425a8"},{"version":"CommandV1","origId":503877321547893,"guid":"34588d67-d966-4475-acf9-0a0fc7def329","subtype":"command","commandType":"auto","position":19.0,"command":"df.registerTempTable(\"messages\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a3cb283f-8ba0-4409-a766-8cace4e5db21"},{"version":"CommandV1","origId":503877321547894,"guid":"85d91110-fbdd-472d-957d-d7dc7629b324","subtype":"command","commandType":"auto","position":20.0,"command":"%md\n## Exercise 1\n\nHow many messages of each type (ERROR, INFO, WARN) are there?\n\n**HINT**: Use your DataFrame knowledge.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"330bf6b7-2bce-4ad0-b02f-a059bf412ab9"},{"version":"CommandV1","origId":503877321547895,"guid":"891b6d68-eeff-447f-81be-9487eedf2351","subtype":"command","commandType":"auto","position":21.0,"command":"%sql select messageType, count(messageType) from messages group by messageType","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6562c802-aa3b-415e-b46b-ed119e460923"},{"version":"CommandV1","origId":503877321547896,"guid":"7eebf84f-5119-4b96-834d-742d4ef04bb4","subtype":"command","commandType":"auto","position":22.0,"command":"%md \n## Exercise 2\n\nModify the `Runner`, above, to keep only the ERROR messages.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fc6eef9e-d0d6-466c-a64a-062c88cf2015"},{"version":"CommandV1","origId":503877321547897,"guid":"34af130e-0e4d-43ca-8d75-53cdd682c09c","subtype":"command","commandType":"auto","position":23.0,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7e5727f7-9f5e-47b0-8cc5-ccdb9b4b44b5"},{"version":"CommandV1","origId":503877321547898,"guid":"e269fb7c-ba64-4a57-bed6-93a82ec95b5e","subtype":"command","commandType":"auto","position":24.0,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ec3c93a7-9aad-40e0-8b71-23844164d678"}],"dashboards":[],"guid":"4db08785-1247-4416-bddb-c113ef20b69c","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}