{"version":"NotebookV1","origId":503877321547903,"name":"Solution","language":"scala","commands":[{"version":"CommandV1","origId":503877321547905,"guid":"f02636b9-b162-4605-b6d9-1765b253fc9a","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n# Solutions to Lab Exercises","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"aed155e0-0fbc-41c1-95b6-1b4ea70ee398"},{"version":"CommandV1","origId":503877321547906,"guid":"1643ccfa-5a1f-4b44-9ce4-2ca193cea7b6","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n## Exercise 1","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"496a0403-10d4-4ee7-bf16-d14a6fbe2172"},{"version":"CommandV1","origId":503877321547907,"guid":"e186e62b-bef4-4bfa-a615-af7f4df99951","subtype":"command","commandType":"auto","position":3.0,"command":"%sql select messageType, count(messageType) as total from messages group by messageType","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"70897c54-47f6-46fc-863c-030e9dd14a55"},{"version":"CommandV1","origId":503877321547908,"guid":"b4e16c01-c932-45a1-8a63-417875c74545","subtype":"command","commandType":"auto","position":4.0,"command":"%md\n## Exercise 2\n\n### Solution (a)\n\nModify the `flatMap` block as follows:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"929e2442-93c3-426d-b056-2eb35511ec1c"},{"version":"CommandV1","origId":503877321547909,"guid":"a610ca08-4608-4777-a6cb-1f2f6b9f23b0","subtype":"command","commandType":"auto","position":5.0,"command":"val keepLogsStream = ds.flatMap { line =>\n  line match {\n    // The following line is the change.\n    case LogLinePattern(timeString, messageType, message) if messageType == \"ERROR\" => {\n      val timestamp = new Timestamp(DateFmt.parse(timeString).getTime)\n      val logMessage = LogMessage(messageType, timestamp, message)\n      Some(logMessage)\n    }\n        \n    case _ => None // malformed line\n  }\n}","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"80537d74-9b8c-4a23-9068-b80dc9bd872e"},{"version":"CommandV1","origId":503877321547910,"guid":"9e47c7a8-0dea-4d4b-b294-6686cd8432e7","subtype":"command","commandType":"auto","position":6.0,"command":"%md \n### Solution (b)\n\nYou could also add a `filter` operation to the original, unmodified `keepLogsStream`:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f82ba00a-2026-4630-a5ef-9a68c8a26f7c"},{"version":"CommandV1","origId":503877321547911,"guid":"c2a87a96-b818-4d3b-953b-f18350fd803a","subtype":"command","commandType":"auto","position":7.0,"command":"val filteredStream = keepLogsStream.filter { message => message.messageType == \"ERROR\" }","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d748671a-8c2e-439b-b56e-f7f31aa8bb4f"},{"version":"CommandV1","origId":503877321547912,"guid":"5137f8fc-13b3-4389-9b37-1eb177c4c455","subtype":"command","commandType":"auto","position":8.0,"command":"%md Then, you'd have to modify the `foreachRDD` block so that it runs against `filteredStream`, instead of `keepLogsStream`.\n\nSolution (a) is likely to be more efficient, however.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"372e0001-a36b-4766-991f-3738d5a25da5"},{"version":"CommandV1","origId":503877321547913,"guid":"5277cbbb-ef12-49dc-bb33-1f0d6d13abbe","subtype":"command","commandType":"auto","position":9.0,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6611fbf7-373a-42e0-a2a3-e31f731b31a8"}],"dashboards":[],"guid":"805ef6b1-2b53-4c27-a0af-e832a66b0ddd","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}