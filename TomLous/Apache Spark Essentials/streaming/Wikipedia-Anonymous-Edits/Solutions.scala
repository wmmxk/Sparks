{"version":"NotebookV1","origId":503877321548461,"name":"Solutions","language":"scala","commands":[{"version":"CommandV1","origId":503877321548463,"guid":"602d3f83-67e3-44ad-824f-7418c809d389","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n# Spark Streaming and Wikipedia ![Wikipedia Logo](http://sameerf-dbc-labs.s3-website-us-west-2.amazonaws.com/data/wikipedia/images/w_logo_for_labs.png)\n\n## Solutions to Exercises and Questions","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"759706be-315a-48af-a0b7-f1101dc57508"},{"version":"CommandV1","origId":503877321548464,"guid":"a8dd135c-d8ed-4d9e-a935-a6d5dcb541cc","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n### Exercise 1\n\n_Remove the United States, Canada, Australia, New Zealand and the UK from the data and re-plot the results, to see who's editing English Wikipedia entries from countries where English is not the primary language._","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"94de764d-c887-4850-9293-3d8edade5b18"},{"version":"CommandV1","origId":503877321548465,"guid":"c81a782a-303d-41e9-aa84-bfaf17c25be6","subtype":"command","commandType":"auto","position":3.0,"command":"%md \nThere are several possible solutions to this exercise. Here's one:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6f0c04ca-e227-4515-84e1-916f9645a834"},{"version":"CommandV1","origId":503877321548466,"guid":"f767b15b-1166-4e3c-a7cc-651b4cf14a70","subtype":"command","commandType":"auto","position":4.0,"command":"display(anonDFCounts.filter(($\"country\" !== \"USA\") && ($\"country\" !== \"GBR\") && ($\"country\" !== \"CAN\") && ($\"country\" !== \"AUS\") && ($\"country\" !== \"NZL\")))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c808dffe-ca56-4ac0-972b-875568c49395"},{"version":"CommandV1","origId":503877321548467,"guid":"3a81b157-520b-4705-9f0a-4aa11aefae0b","subtype":"command","commandType":"auto","position":5.0,"command":"%md\nBut this one's more compact:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5675c326-116a-4e69-a3f9-f78b9af42e4e"},{"version":"CommandV1","origId":503877321548468,"guid":"1cca3177-2a71-44ca-bc44-8f55573e696a","subtype":"command","commandType":"auto","position":6.0,"command":"display(anonDFCounts.filter(! ($\"country\".isin(\"USA\", \"CAN\", \"GBR\", \"AUS\", \"NZL\"))))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"35bebf04-e747-4975-ad73-ad314be6cdf8"},{"version":"CommandV1","origId":503877321548469,"guid":"ec56349d-29a5-46b5-aba4-099b84b4ce3b","subtype":"command","commandType":"auto","position":7.0,"command":"%md\n### Exercise 2\n\n_Choose another language, and figure out where_ that _Wikipedia is being edited. The server currently serves up changes for the following Wikipedias_","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"106f385b-b94d-428f-bef7-a6216b633f98"},{"version":"CommandV1","origId":503877321548470,"guid":"f275b190-0b94-430b-a219-f9d78e69ebed","subtype":"command","commandType":"auto","position":8.0,"command":"val code = \"es\" // easy to change in one place\nval langDF = cleanedDF.filter(($\"wikipedia\" === code) && ($\"isAnonymous\" === true))\n                      .select($\"user\".as(\"ipAddress\"), $\"geoCountryCode3\".as(\"country\"))\n                      .filter(! isnull($\"country\"))\n                      .groupBy($\"ipAddress\", $\"country\")\n                      .count()\n                      .select($\"country\", $\"count\")\ndisplay(langDF)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"36d81a71-f7da-4862-8ca4-fe5b0a0c4aea"}],"dashboards":[],"guid":"d5651b16-3c9b-4de5-ba35-ad312bb3cc7c","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}