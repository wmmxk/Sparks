{"version":"NotebookV1","origId":503877321546013,"name":"08-DA-Wiki-NLP","language":"scala","commands":[{"version":"CommandV1","origId":503877321546015,"guid":"0cb3f102-1c16-494c-8e6b-97b40b1e7b2b","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n\n#![Wikipedia Logo](http://sameerf-dbc-labs.s3-website-us-west-2.amazonaws.com/data/wikipedia/images/w_logo_for_labs.png)\n\n# Explore English Wikipedia via DataFrames and RDD API\n### Time to complete: 20 minutes\n\n#### Business Questions:\n\n* Question # 1) What percentage of Wikipedia articles were edited in the past month (before the data was collected)?\n* Question # 2) How many of the 1 million articles were last edited by ClueBot NG, an anti-vandalism bot?\n* Question # 3) Which user in the 1 million articles was the last editor of the most articles?\n* Question # 4) Can you display the titles of the articles in Wikipedia that contain a particular word?\n* Question # 5) Can you extract out all of the words from the Wikipedia articles? (bag of words)\n* Question # 6) What are the top 15 most common words in the English language?\n* Question # 7) After removing stop words, what are the top 10 most common words in the english language? \n* Question # 8) How many distinct/unique words are in noStopWordsListDF?\n\n\n#### Technical Accomplishments:\n\n* Work with 2% of the sum of all human knowledge!","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"844175b4-d28a-429b-998b-1050d1d04501"},{"version":"CommandV1","origId":503877321546016,"guid":"0d0f0d80-97f5-4ed1-8ce5-ee009859597b","subtype":"command","commandType":"auto","position":2.0,"command":"%md Attach to, and then restart your cluster first to clear out old memory caches and get to a default, standard environment. The restart should take 1 - 2 minutes.\n\n![Restart Cluster](http://curriculum-release.s3-website-us-west-2.amazonaws.com/wiki-book/general/restart_cluster.png)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1c7bf389-b52f-4a7c-ad6a-b2475b97201f"},{"version":"CommandV1","origId":503877321546017,"guid":"96499793-d320-4e92-82e8-f0115b7ffbc2","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n### Getting to know the Data\nLocate the Parquet data from the demo using `dbutils`:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"26ad24d0-4758-43f1-a0ae-cd488df56a77"},{"version":"CommandV1","origId":503877321546018,"guid":"8e8fee6b-f512-495b-a583-f8124561babe","subtype":"command","commandType":"auto","position":4.0,"command":"display(dbutils.fs.ls(\"/mnt/wikipedia-readonly/en_wikipedia/march_5_snapshot/flattenedParquet_updated3days_30partitions/\"))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2ef2e321-7c3e-404b-b400-9201788f5578"},{"version":"CommandV1","origId":503877321546019,"guid":"0305f028-d920-4466-a1d0-079ad5421c55","subtype":"command","commandType":"auto","position":5.0,"command":"%md These are the 30 parquet files (~660 MB total) from the English Wikipedia Articles (March 5, 2016 snapshot) that were last updated between March 3, 2016 - March 5, 2016, inclusive.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8b8bb6e6-f1d7-4d73-9a54-51a9923d700d"},{"version":"CommandV1","origId":503877321546020,"guid":"6974df0c-5ad5-4e4a-b2ec-6c47dc44bb35","subtype":"command","commandType":"auto","position":6.0,"command":"%md Load the articles into memory and lazily cache them:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ae1b5ee9-5be7-4c93-b1fc-9f8e6576086c"},{"version":"CommandV1","origId":503877321546021,"guid":"abe61106-f38f-443b-b06d-6bff5cec1578","subtype":"command","commandType":"auto","position":7.0,"command":"val wikiDF = sqlContext.read.parquet(\"dbfs:/mnt/wikipedia-readonly/en_wikipedia/march_5_snapshot/flattenedParquet_updated3days_30partitions/\").cache","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"398fc911-4c68-4a97-9b92-73b10a3c9992"},{"version":"CommandV1","origId":503877321546022,"guid":"6e87180b-24c7-46fa-ae4e-c5755fdae747","subtype":"command","commandType":"auto","position":8.0,"command":"%md Notice how fast `printSchema()` runs... this is because we can derive the schema from the Parquet metadata:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0e3ad4e5-b549-4f22-be2a-2be16541db50"},{"version":"CommandV1","origId":503877321546023,"guid":"96890bba-ff4b-4d04-92e5-54c6b8f75ba0","subtype":"command","commandType":"auto","position":9.0,"command":"wikiDF.printSchema()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"33165cb8-0f19-47f9-872d-bb295ecdbfff"},{"version":"CommandV1","origId":503877321546024,"guid":"38c7172a-e1d4-44ed-9c53-24fefec703bb","subtype":"command","commandType":"auto","position":10.0,"command":"%md Look at the first 5 rows:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d50f4d2a-2070-470f-9797-8b57711a9ef0"},{"version":"CommandV1","origId":503877321546025,"guid":"95a19ca9-de26-4dbf-a5af-d511a9965923","subtype":"command","commandType":"auto","position":11.0,"command":"display(wikiDF.limit(5))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"576fabba-115b-4d9f-95c3-28e90b7c116b"},{"version":"CommandV1","origId":503877321546026,"guid":"418dfa83-50c4-4dd2-b151-da5f5937a89c","subtype":"command","commandType":"auto","position":12.0,"command":"%md Let's count how many total articles we have. (Note that when using a local mode cluster, the next command will take **1 - 2 minutes**, so you may want to skip ahead and read some of the next cells:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"191a7eab-295d-4cab-93bd-c9658edcc282"},{"version":"CommandV1","origId":503877321546027,"guid":"70c946c0-f8dc-4895-9e17-81f68ecf3d0c","subtype":"command","commandType":"auto","position":13.0,"command":"// You can monitor the progress of this count + cache materialization via the Spark UI's storage tab\nprintf(\"%,d articles\\n\", wikiDF.count)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8deea040-0a5a-491f-b2ab-bf90dc9f4242"},{"version":"CommandV1","origId":503877321546028,"guid":"55628f9c-cfa5-4211-9ba1-206c665cec1e","subtype":"command","commandType":"auto","position":14.0,"command":"%md The DataFrame will use 1.9 GB of Memory (of the 2.4 GB total available).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3520a2dd-689f-45e9-b478-bf29561864af"},{"version":"CommandV1","origId":503877321546029,"guid":"898a2791-9126-405d-a059-a226f2f7470e","subtype":"command","commandType":"auto","position":15.0,"command":"%md This lab is meant to introduce you to working with unstructured text data in the Wikipedia articles. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3bb9b2d7-0d2d-4166-8f65-b8811665f015"},{"version":"CommandV1","origId":503877321546030,"guid":"80ff6a24-8fae-4bb1-8080-628946c23922","subtype":"command","commandType":"auto","position":16.0,"command":"%md In this lab, among other tasks, we will apply basic Natural Language Processing to the article text to extract out a bag of words.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6843de81-c633-4d11-898f-a3d8681e8bc1"},{"version":"CommandV1","origId":503877321546031,"guid":"efc03272-a89a-463e-96a0-5d0d8f8e779b","subtype":"command","commandType":"auto","position":17.0,"command":"%md By now the `.count()` operation might be completed. Go back up and check and only proceed after the count has completed. You should see the count's results as 111,495 items.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f28104e3-c846-4987-b4f1-644ecf9fb01e"},{"version":"CommandV1","origId":503877321546032,"guid":"b6bd9180-1960-477e-9e6b-2ae0e2245b75","subtype":"command","commandType":"auto","position":18.0,"command":"%md Run `.count()` again to see the speed increase:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"811b6843-1d4b-4056-897b-651a42aac964"},{"version":"CommandV1","origId":503877321546033,"guid":"27739eab-42c5-41f7-96f1-41caf7b75357","subtype":"command","commandType":"auto","position":19.0,"command":"printf(\"%,d articles\\n\", wikiDF.count)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"727064e4-0486-4f24-a371-fbb768fe9f8b"},{"version":"CommandV1","origId":503877321546034,"guid":"5fdae8d6-2119-4565-aa81-dfad6285f71a","subtype":"command","commandType":"auto","position":20.0,"command":"%md That's pretty impressive! We can scan through 111 thousand recent articles of English Wikipedia using a single 3.7 GB Executor in under 1 second.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f6520f3e-b6b6-40a5-acf4-c78fb470d9b1"},{"version":"CommandV1","origId":503877321546035,"guid":"0a39ead9-cc71-4d4b-9bf1-a40db582c6f2","subtype":"command","commandType":"auto","position":21.0,"command":"%md Register the DataFrame as a temporary table, so we can execute SQL against it:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0091fb36-9df5-494c-9d0b-90a51a83e9a7"},{"version":"CommandV1","origId":503877321546036,"guid":"6c76a27e-5625-4cea-947f-6c3355871edf","subtype":"command","commandType":"auto","position":22.0,"command":"wikiDF.registerTempTable(\"wikipedia\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"afb9a34c-19a8-430b-8bd6-e338a755df5b"},{"version":"CommandV1","origId":503877321546037,"guid":"694eac19-98cd-4dc9-8dcc-a23503267113","subtype":"command","commandType":"auto","position":23.0,"command":"%md \n### Question #1:\n** How many days of data is in the DataFrame? **","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7bc912b4-d3b7-4ff7-86e3-d3739f39ebac"},{"version":"CommandV1","origId":503877321546038,"guid":"58fd797e-7359-45d8-9e57-7671862aeced","subtype":"command","commandType":"auto","position":24.0,"command":"%md ** Challenge 1:**  Can you write this query using DataFrames? Hint: Start by importing the sql.functions.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6ad021a2-bdab-45c9-8cbc-064057b4958a"},{"version":"CommandV1","origId":503877321546039,"guid":"aaad9471-76ec-42c4-a577-f88ef1f26ce6","subtype":"command","commandType":"auto","position":25.0,"command":"// Type your answer here...","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b58f76be-23b3-4145-b746-76df893e90b9"},{"version":"CommandV1","origId":503877321546040,"guid":"79b9dcb8-4d6c-4081-823e-f9b6fbc600d8","subtype":"command","commandType":"auto","position":26.0,"command":"%md At the time of collection (March 5, 2016) Wikipedia had 5.096 million articles. What % of Wikipedia are we working with?","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4f8d870a-f4a1-4de2-8dbc-8cc05545ea3c"},{"version":"CommandV1","origId":503877321546041,"guid":"0ee1a938-467d-42a3-9fbb-0f5b86e3eff3","subtype":"command","commandType":"auto","position":27.0,"command":"printf(\"%.2f%%\\n\", wikiDF.count()/5096292.0*100)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"28c9d07e-984a-4264-a6f9-41f627c2cddd"},{"version":"CommandV1","origId":503877321546042,"guid":"eede2dc4-62c6-4be7-b869-d55168fa2709","subtype":"command","commandType":"auto","position":28.0,"command":"%md About 2% of English Wikipedia. Here are 10 such articles:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"28b0fc98-8d6d-41b4-a28e-8845b9fb1f16"},{"version":"CommandV1","origId":503877321546043,"guid":"40c49d0f-e26e-4bc2-9052-bf3cc3540d88","subtype":"command","commandType":"auto","position":29.0,"command":"%sql SELECT title, lastrev_pdt_time FROM wikipedia LIMIT 10;","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"36d53987-85a7-475b-b874-2c6a38f74cee"},{"version":"CommandV1","origId":503877321546044,"guid":"3be74ef3-3eba-424d-9538-10071daf7f87","subtype":"command","commandType":"auto","position":30.0,"command":"%md \n### Question #2:\n** How many of the 111 thousand articles were last edited by <a href=\"https://en.wikipedia.org/wiki/User:ClueBot_NG\" target=\"_blank\">ClueBot NG</a>, an anti-vandalism bot? **","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c4d4e61c-9514-4652-b95c-34e5ed558258"},{"version":"CommandV1","origId":503877321546045,"guid":"d9a4c8cb-1b8d-404a-98f1-88fc325a0336","subtype":"command","commandType":"auto","position":31.0,"command":"%md **Challenge 2:**  Write a SQL query to answer this question. Then write a second query to display the first 10.\nHint: The username to search for is \"ClueBot NG\".","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fd48644e-0cbd-4d90-a625-b3c5b8cee4b7"},{"version":"CommandV1","origId":503877321546046,"guid":"196107a3-72d4-4c91-b868-1cf7d12bdfc2","subtype":"command","commandType":"auto","position":32.0,"command":"// Type your answer here... (tip: you must remove this comment)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1f5a01e4-a6bc-4eb2-af7d-e17dc65f39be"},{"version":"CommandV1","origId":503877321546047,"guid":"a9be42ac-9e26-4b96-a4d9-1ff144aa7801","subtype":"command","commandType":"auto","position":33.0,"command":"%md **Challenge 3:** Update your previous query to show the first 10 records","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"785e60f3-fa56-4314-997e-ad113575fd85"},{"version":"CommandV1","origId":503877321546048,"guid":"a08b499c-6a7b-4582-b534-cd201f6a986c","subtype":"command","commandType":"auto","position":34.0,"command":"// Type your answer here... (tip: you most remove this comment)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"29f00906-cd80-4636-8e02-ac03f3485e13"},{"version":"CommandV1","origId":503877321546049,"guid":"e3389023-a443-4452-9676-b657e6fc92b5","subtype":"command","commandType":"auto","position":35.0,"command":"%md You can study the specifc revisions like so: **https://<span></span>en.wikipedia.org/?diff=####**\n\nFor example: <a href=\"https://en.wikipedia.org/?diff=708113872\" target=\"_blank\">https://<span></span>en.wikipedia.org/?diff=708113872</a>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ac4df9f1-246c-4bf6-a30b-d63e266778cd"},{"version":"CommandV1","origId":503877321546050,"guid":"44124a9a-7592-4183-8231-2f558a6d2830","subtype":"command","commandType":"auto","position":36.0,"command":"%md \n### Question #3:\n** Which user in the 111 thousand articles was the last editor of the most articles? **","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f17a1157-1b9f-494f-89f2-4be8135264bc"},{"version":"CommandV1","origId":503877321546051,"guid":"a98c7913-32dd-4f4e-a0ee-e58ca7357131","subtype":"command","commandType":"auto","position":37.0,"command":"%md Here's a slightly more complicated query:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ca7d5979-15fb-4f84-8f4d-06beb8642192"},{"version":"CommandV1","origId":503877321546052,"guid":"5321d361-fcf8-414c-b22f-dbfd4d3beffb","subtype":"command","commandType":"auto","position":38.0,"command":"%sql SELECT contributorusername, COUNT(contributorusername) FROM wikipedia GROUP BY contributorusername ORDER BY COUNT(contributorusername) DESC; ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4ab60136-005c-4271-b782-a651b28f6f95"},{"version":"CommandV1","origId":503877321546053,"guid":"f0e305af-016a-4fd1-bcec-99861b22d22a","subtype":"command","commandType":"auto","position":39.0,"command":"%md Hmm, looks are bots are quite active in maintaining Wikipedia.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4c6d7f36-7588-4248-bbad-1d0140730283"},{"version":"CommandV1","origId":503877321546054,"guid":"c36166c7-a83d-49f0-80f9-59bc9ef1188f","subtype":"command","commandType":"auto","position":40.0,"command":"%md Interested in learning more about the bots that edit Wikipedia? Check out: <a href=\"https://en.wikipedia.org/wiki/Wikipedia:List_of_bots_by_number_of_edits\" target=\"_blank\">Wikipedia:List_of_bots_by_number_of_edits</a>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"13e7d46a-2ed7-4df4-824c-b2046df9108d"},{"version":"CommandV1","origId":503877321546055,"guid":"a7ab97ad-4565-4e1c-b106-127e9fb31b12","subtype":"command","commandType":"auto","position":41.0,"command":"%md \n### Question #4:\n** Can you display the titles of the articles in Wikipedia that contain a particular word? **","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"abd2257b-18a6-4810-920e-2afcc125f7d0"},{"version":"CommandV1","origId":503877321546056,"guid":"dce2385b-6c14-4d35-93a0-4d0269c39360","subtype":"command","commandType":"auto","position":42.0,"command":"%md Start by registering a User Defined Function (UDF) that can search for a string in the text of an article.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a59985b3-fdd3-469d-ae5d-251bac8c542f"},{"version":"CommandV1","origId":503877321546057,"guid":"ad7f4bd8-06a4-4b86-8895-3254c5ba8e3c","subtype":"command","commandType":"auto","position":43.0,"command":"// Register a function that can search if a string is found.\n\nval containsWord = (s: String, w: String) => {\n  (s != null && s.indexOfSlice(w) >= 0)\n}\nsqlContext.udf.register(\"containsWord\", containsWord)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8259f1fd-d93f-4e93-9be7-002b2b4285a4"},{"version":"CommandV1","origId":503877321546058,"guid":"a56b7305-6e5a-4665-9aea-f89ae1dbf75f","subtype":"command","commandType":"auto","position":44.0,"command":"%md Verify that the `containsWord` function is working as intended:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ca30c7a2-72ec-43a7-a173-8ff49f9b65f2"},{"version":"CommandV1","origId":503877321546059,"guid":"f5a5594d-0a5d-47f4-8799-27b936ae8f62","subtype":"command","commandType":"auto","position":45.0,"command":"// Look for the word 'test' in the first string\ncontainsWord(\"hello astronaut, how's space?\", \"test\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f64bd3fe-1e36-431c-8dfe-ac99c2e6a750"},{"version":"CommandV1","origId":503877321546060,"guid":"7930090c-d397-4a5d-b57b-c49cc4a15bce","subtype":"command","commandType":"auto","position":46.0,"command":"// Look for the word 'space' in the first string\ncontainsWord(\"hello astronaut, how's space?\", \"space\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e187c1a2-2529-4d78-9b79-e53277b9dbf0"},{"version":"CommandV1","origId":503877321546061,"guid":"80cc0bf7-d3dd-49ca-8401-7aa9ee34948b","subtype":"command","commandType":"auto","position":47.0,"command":"%md  Use a parameterized query so you can easily change the word to search for:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3fb80bf2-088c-4f38-a031-02ead6032358"},{"version":"CommandV1","origId":503877321546062,"guid":"c4a8b282-ec01-4090-8df5-5434657f0e5e","subtype":"command","commandType":"auto","position":48.0,"command":"%sql  select title from wikipedia where containsWord(text, '$word')","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b899f70a-db12-4dba-9a19-7fb71b9c0784"},{"version":"CommandV1","origId":503877321546063,"guid":"6ed6e2fb-09ab-4d4f-806f-1c18acf4de66","subtype":"command","commandType":"auto","position":49.0,"command":"%md Try typing in `NASA` or `Manhattan` into the search box above and hit SHIFT + ENTER.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c66ea66e-d260-4c7c-9782-4886f5c2152a"},{"version":"CommandV1","origId":503877321546064,"guid":"24bf07cf-d8c3-4279-8485-cd32a37f9df3","subtype":"command","commandType":"auto","position":50.0,"command":"%md \n### Question #5:\n** Can you extract out all of the words from the Wikipedia articles? ** (Create a bag of words)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b10f4ff5-92c5-4d85-a952-772510d852ed"},{"version":"CommandV1","origId":503877321546065,"guid":"f18518b0-585d-4821-9a05-98713d69b65c","subtype":"command","commandType":"auto","position":51.0,"command":"%md Use Spark.ml's RegexTokenizer to read an input column of 'text' and write a new output column of 'words':","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dda5d27b-d5e7-4746-a261-4855be31eda8"},{"version":"CommandV1","origId":503877321546066,"guid":"7a92aa96-d77f-4b3f-be28-c78b22af7508","subtype":"command","commandType":"auto","position":52.0,"command":"import org.apache.spark.ml.feature.RegexTokenizer\n \nval tokenizer = new RegexTokenizer()\n  .setInputCol(\"text\")\n  .setOutputCol(\"words\")\n  .setPattern(\"\\\\W+\")\n\nval wikiWordsDF = tokenizer.transform(wikiDF)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3f47ee49-138d-4ce8-8a13-58fa11b63a4c"},{"version":"CommandV1","origId":503877321546067,"guid":"ff94e02b-f93b-450c-8c8e-b24bfd1b68db","subtype":"command","commandType":"auto","position":53.0,"command":"wikiWordsDF.show(5)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a8a8344e-bd1e-46da-b83f-d29466eeb90c"},{"version":"CommandV1","origId":503877321546068,"guid":"6648d8da-b807-47cf-9037-3976c661b3f8","subtype":"command","commandType":"auto","position":54.0,"command":"wikiWordsDF.select($\"title\", $\"words\").first","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e8f51f17-0699-4a58-a225-afb908f368ad"},{"version":"CommandV1","origId":503877321546069,"guid":"2bfec50a-26e0-4514-87fe-ae1efd01dfe4","subtype":"command","commandType":"auto","position":55.0,"command":"%md \n### Question #6:\n** What are the top 15 most common words in the English language? ** Compute this only on a random 10% of the 111 thousand articles.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3747ef7a-c2e1-43a5-ac4f-e0be8487fd19"},{"version":"CommandV1","origId":503877321546070,"guid":"1328ba3f-b39a-4a6b-9e8b-5111e48df9b5","subtype":"command","commandType":"auto","position":56.0,"command":"%md For this analysis, we should get reasonably accurate results even if we work on just 10% of the 111 thousand articles. Plus, this will speed things up tremendously. Note that this means about 11,000 articles","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ee0fb555-9a9a-4ac4-acdc-4e77519774bb"},{"version":"CommandV1","origId":503877321546071,"guid":"edbb0977-9df5-4e72-af32-be59e56fcfc7","subtype":"command","commandType":"auto","position":57.0,"command":"val tenPercentDF = wikiWordsDF.sample(false, .10, 555)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c3e316db-bbcb-4456-9ad4-009bfb315a91"},{"version":"CommandV1","origId":503877321546072,"guid":"8a35b503-2ef5-45d9-accc-b128fad08cb7","subtype":"command","commandType":"auto","position":58.0,"command":"printf(\"%,d words (total)\\n\", wikiWordsDF.count)\nprintf(\"%,d words (sample)\\n\", tenPercentDF.count)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a09f2d65-a0fb-4923-8c40-7b197fd8054c"},{"version":"CommandV1","origId":503877321546073,"guid":"3f766939-9644-47e0-a86e-92fc5419c933","subtype":"command","commandType":"auto","position":59.0,"command":"%md Note that the `words` column contains arrays of Strings:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"eaf45e14-880d-40e8-aef6-aba91cf15963"},{"version":"CommandV1","origId":503877321546074,"guid":"fe6fca98-dfa7-439c-a3f9-083169303426","subtype":"command","commandType":"auto","position":60.0,"command":"tenPercentDF.select($\"words\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e709cfeb-edef-43f7-afce-7bedcb0b3a5b"},{"version":"CommandV1","origId":503877321546075,"guid":"283bac5c-7d5f-41c5-a1a3-e5a21526191b","subtype":"command","commandType":"auto","position":61.0,"command":"%md Let's explode the `words` column into a table of one word per row:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"23ab0e36-2be3-479b-b571-be48291f4193"},{"version":"CommandV1","origId":503877321546076,"guid":"ff4e72d5-4d9f-4757-b7f9-d4d7b34f2a1f","subtype":"command","commandType":"auto","position":62.0,"command":"import org.apache.spark.sql.{functions => func}\nval tenPercentWordsListDF = tenPercentDF.select(func.explode($\"words\").as(\"word\"))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"01087545-c344-40e3-bdf3-ba11083c3420"},{"version":"CommandV1","origId":503877321546077,"guid":"907b16a0-b29b-4437-8843-b0ff7cbd39e6","subtype":"command","commandType":"auto","position":63.0,"command":"display(tenPercentWordsListDF)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8b568a2b-fad0-4cff-ae3d-84130a2da978"},{"version":"CommandV1","origId":503877321546078,"guid":"b87978cd-7c5d-4683-aab2-8bb7d7307c6f","subtype":"command","commandType":"auto","position":64.0,"command":"printf(\"%,d words\\n\", tenPercentWordsListDF.cache().count())","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4e6e635e-b50b-479c-a0d1-ae73b720ed54"},{"version":"CommandV1","origId":503877321546079,"guid":"8ac46b67-75e2-45c6-8c8b-f5691829d14b","subtype":"command","commandType":"auto","position":65.0,"command":"%md The onePercentWordsListDF contains 29.8 million words.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"777c1b49-1705-46f4-9de4-f4575475cad8"},{"version":"CommandV1","origId":503877321546080,"guid":"e8e9f598-bc0b-4149-a8dc-f95a0062f9c3","subtype":"command","commandType":"auto","position":66.0,"command":"%md Finally, run a wordcount on the exploded table:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4eaf4b90-7780-4300-86bd-9bd1227468a6"},{"version":"CommandV1","origId":503877321546081,"guid":"de26e748-dff1-465d-a787-e7c58511e385","subtype":"command","commandType":"auto","position":67.0,"command":"val wordGroupCountDF = tenPercentWordsListDF\n                      .groupBy(\"word\")  // group\n                      .agg(func.count(\"word\").as(\"counts\"))  // aggregate\n                      .sort(func.desc(\"counts\"))  // sort\n\nwordGroupCountDF.show(15)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ebf17114-dbc5-49e1-b48f-cbfcc7c26885"},{"version":"CommandV1","origId":503877321546082,"guid":"b538e5ab-079b-463e-8dc5-e07479c88547","subtype":"command","commandType":"auto","position":68.0,"command":"%md These would be good <a href=\"https://en.wikipedia.org/wiki/Stop_words\" target=\"_blank\">stop words</a> to filter out before running Natural Language Processing algorithms on our data.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f106c0bc-b7fe-49bd-b7a7-e4949244a29d"},{"version":"CommandV1","origId":503877321546083,"guid":"6e70139f-e391-4bc0-9fec-54d072945a07","subtype":"command","commandType":"auto","position":69.0,"command":"%md \n### Question #7:\n** After removing stop words, what are the top 10 most common words in the english language? ** Compute this only on a random 10% of the 111 thousand articles.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"be7ab9d3-7f7f-4df2-b698-27e30a14adbe"},{"version":"CommandV1","origId":503877321546084,"guid":"8ce500f9-91ef-4bbb-b305-8618f4580a9e","subtype":"command","commandType":"auto","position":70.0,"command":"%md Use Spark.ml's stop words remover:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"35f31654-b09d-4414-98a3-6afb4a13f59d"},{"version":"CommandV1","origId":503877321546085,"guid":"e52b879a-e8ed-4b02-8cfe-f4073aec1804","subtype":"command","commandType":"auto","position":71.0,"command":"import org.apache.spark.ml.feature.StopWordsRemover\n\nval remover = new StopWordsRemover()\n  .setInputCol(\"words\")\n  .setOutputCol(\"noStopWords\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8a9c51e1-b93f-4ebb-9744-4902e56b6ec8"},{"version":"CommandV1","origId":503877321546086,"guid":"5fa1250a-210b-4ff0-8730-fcd5e3014a59","subtype":"command","commandType":"auto","position":72.0,"command":"%md Notice the removal of words like \"about\", \"the\",  etc:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"11afa69e-71bb-4331-a3e5-69f8606d0afd"},{"version":"CommandV1","origId":503877321546087,"guid":"83032094-0d0c-45bc-88fc-45518a60bad9","subtype":"command","commandType":"auto","position":73.0,"command":"remover.transform(tenPercentDF).select(\"id\", \"title\", \"words\", \"noStopWords\").show(15)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"01d2e780-2b9f-4316-88cc-facf42a8eb34"},{"version":"CommandV1","origId":503877321546088,"guid":"8813dd73-6de5-4367-bd99-8a17be74efca","subtype":"command","commandType":"auto","position":74.0,"command":"val noStopWordsListDF = remover.transform(tenPercentDF).select(func.explode($\"noStopWords\").as(\"word\"))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ea22a232-20b4-4ca2-bbd2-e0965396dbed"},{"version":"CommandV1","origId":503877321546089,"guid":"2fd22039-ee70-4a9a-a9a0-bd0c4da8aa24","subtype":"command","commandType":"auto","position":75.0,"command":"noStopWordsListDF.show(7)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7609d077-51d1-47a9-bc42-0423a7cb3b63"},{"version":"CommandV1","origId":503877321546090,"guid":"9ea5bbe3-5b5d-41b7-8315-c6ed8f145c54","subtype":"command","commandType":"auto","position":76.0,"command":"%md The tenPercentWordsListDF (which included stop words) contained 29.8 million words. How many words are in the noStopWordsListDF?","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"db88895f-db64-4058-b513-dbda685a2cd3"},{"version":"CommandV1","origId":503877321546091,"guid":"383411c4-b4e0-425c-bbd5-f57dd552f131","subtype":"command","commandType":"auto","position":77.0,"command":"printf(\"%,d words\\n\", noStopWordsListDF.cache.count)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ceb096f9-f61e-4767-97fe-a73211c1387c"},{"version":"CommandV1","origId":503877321546092,"guid":"3a59d63e-427f-4bb4-9b51-c7c42544bad1","subtype":"command","commandType":"auto","position":78.0,"command":"%md 22.4 million words remain. That means about 7.4 million words in our 10% sample were actually stop words.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0bd59604-7f1b-4d60-a4dc-17f01a69c5c5"},{"version":"CommandV1","origId":503877321546093,"guid":"cc85d390-dc2b-4be2-a77b-a00b8c2d150f","subtype":"command","commandType":"auto","position":79.0,"command":"%md Finally, let's see the top 15 words now:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ac7bb1c3-d8ec-4b01-b5c9-658506609545"},{"version":"CommandV1","origId":503877321546094,"guid":"db579062-0371-4141-8e7c-e73370eae33b","subtype":"command","commandType":"auto","position":80.0,"command":"val noStopWordsGroupCount = noStopWordsListDF\n                      .groupBy(\"word\")  // group\n                      .agg(func.count(\"word\").as(\"counts\"))  // aggregate\n                      .sort(func.desc(\"counts\"))  // sort\n\nnoStopWordsGroupCount.show(15)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"48e61ab4-fe23-4352-b1dd-83b515393eba"},{"version":"CommandV1","origId":503877321546095,"guid":"7a4ac5ef-14ca-4feb-9692-3a578d9c35d9","subtype":"command","commandType":"auto","position":81.0,"command":"%md \n### Question #8:\n** How many distinct/unique words are in noStopWordsListDF?**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5b827ff6-18af-4197-98b4-e72a447ea97f"},{"version":"CommandV1","origId":503877321546096,"guid":"628c3e6c-2943-4950-918e-0c2721c581e4","subtype":"command","commandType":"auto","position":82.0,"command":"printf(\"%,d distinct words\", noStopWordsListDF.distinct.count)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"df4c09ae-48b4-4953-a683-c50c54c5f0bf"},{"version":"CommandV1","origId":503877321546097,"guid":"1e0192b0-52bf-4ff2-b044-20adc844b93f","subtype":"command","commandType":"auto","position":83.0,"command":"%md Looks like the Wikipedia corpus has around 700,000 unique words. Probably a lot of these are rare scientific words, numbers, etc.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"969ebcb7-8a9f-4a70-841c-2433e3400f10"},{"version":"CommandV1","origId":503877321546098,"guid":"3fbad462-e64a-4a40-b9f3-c809921ea046","subtype":"command","commandType":"auto","position":84.0,"command":"%md This concludes the English Wikipedia NLP lab.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"80de29f1-04cc-4746-b704-ab03d9621660"}],"dashboards":[],"guid":"e4980bcc-f141-43e1-9c0e-f247a54f2c8d","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}