{"version":"NotebookV1","origId":503877321547340,"name":"13-2.0-Overview-Demo-Dataset","language":"scala","commands":[{"version":"CommandV1","origId":503877321547342,"guid":"93dfdbdf-7eab-4d7d-a215-601eb7f5cee6","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n# Demo 1. Dataset","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"92d7591d-fba6-4bea-b0fd-ee51b9868a38"},{"version":"CommandV1","origId":503877321547343,"guid":"5cc9c6f1-066d-48b9-b001-9bc98c7f8058","subtype":"command","commandType":"auto","position":2.0,"command":"import org.apache.spark.sql.Dataset\n\nimplicit class DatasetDisplay(ds: Dataset[_]) {\n  def display(): Unit = {\n    com.databricks.backend.daemon.driver.EnhancedRDDFunctions.display(ds)\n  }\n}","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"10e839bd-126e-4e1a-8097-2f1e0184ae9e"},{"version":"CommandV1","origId":503877321547344,"guid":"a801005c-bfff-4b4e-b64e-b78a299ee0bb","subtype":"command","commandType":"auto","position":3.0,"command":"dbutils.fs.head(\"/databricks-datasets/samples/population-vs-price/data_geo.csv\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f6b1057d-7604-4514-b4e9-42c568d51d2f"},{"version":"CommandV1","origId":503877321547345,"guid":"7358a02a-76b6-4a82-ad1c-367f49e2c9cc","subtype":"command","commandType":"auto","position":4.0,"command":"display(spark.read.option(\"header\", \"true\").option(\"inferSchema\", \"true\").csv(\"/databricks-datasets/samples/population-vs-price/data_geo.csv\"))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"234d43d9-727e-4d73-89ea-cb27ae7df03a"},{"version":"CommandV1","origId":503877321547346,"guid":"af8f0284-ec69-45fb-92a0-d5f03f7ccb03","subtype":"command","commandType":"auto","position":5.0,"command":"val df = spark.read.option(\"header\", \"true\").option(\"inferSchema\", \"true\").csv(\"/databricks-datasets/samples/population-vs-price/data_geo.csv\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dcd2e070-0792-4c15-9764-daf7ed09e91a"},{"version":"CommandV1","origId":503877321547347,"guid":"adbd6217-e40d-4f5a-a5bf-503c3ac8da3b","subtype":"command","commandType":"auto","position":6.0,"command":"df.printSchema()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3e058007-094a-4672-9416-df5e2308dd51"},{"version":"CommandV1","origId":503877321547348,"guid":"5802378a-a825-4855-bfbe-37da7a89a80e","subtype":"command","commandType":"auto","position":7.0,"command":"case class City(rank: Int, city: String, state: String, stateCode: String, popEstimate: Option[Int], medianSalePrice: Option[Double])","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"48e2597b-63bd-4537-b7cd-d9caa287df68"},{"version":"CommandV1","origId":503877321547349,"guid":"32cc0689-038d-4cfa-9f36-db1b9f4a61bb","subtype":"command","commandType":"auto","position":8.0,"command":"val ds = df.withColumnRenamed(\"2014 rank\", \"rank\")\n           .withColumnRenamed(\"State Code\", \"stateCode\")\n           .withColumnRenamed(\"2014 Population Estimate\", \"popEstimate\")\n           .withColumnRenamed(\"2015 median sales price\", \"medianSalePrice\")\n           .as[City]","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f13e0542-220f-4a7a-aa68-e400d4c74c61"},{"version":"CommandV1","origId":503877321547350,"guid":"c5be89c1-5428-4d60-84f8-d0b73e0f3db6","subtype":"command","commandType":"auto","position":9.0,"command":"display(ds)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f94b8355-a587-47b5-adf9-09dd37fed258"},{"version":"CommandV1","origId":503877321547351,"guid":"b4297abf-0f7f-49cf-8edc-cd1e7052f444","subtype":"command","commandType":"auto","position":10.0,"command":"ds.map(_.city).display()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a920e4ee-dc84-4e9a-8163-5ec184e63d06"},{"version":"CommandV1","origId":503877321547352,"guid":"269f758a-f8e6-4b01-aa2a-ce7e62c4beae","subtype":"command","commandType":"auto","position":11.0,"command":"ds.filter(_.rank <= 20).orderBy($\"rank\").display()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"87740d9b-54d4-49a1-8a61-da6c10210273"}],"dashboards":[],"guid":"112e066c-61c2-4cf5-8c92-34fbe125bc9d","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}