{"version":"NotebookV1","origId":503877321546912,"name":"07-DS-GF-Graph","language":"scala","commands":[{"version":"CommandV1","origId":503877321546914,"guid":"fd888cca-35dc-403d-8e79-539951f18fd9","subtype":"command","commandType":"auto","position":1.0,"command":"%md ### Start with the Bonus Graph D3js Notebook, then return here...\n\n(Note, there is only a ReadMe version of this lab. This will move us along fast into ML...)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1c0a2453-41be-4194-bb2e-5ca8369ba172"},{"version":"CommandV1","origId":503877321546915,"guid":"a5793930-c946-4040-83a5-e0ea19f728b0","subtype":"command","commandType":"auto","position":2.0,"command":"%md ![Wikipedia/Spark Logo](http://curriculum-release.s3-website-us-west-2.amazonaws.com/wiki-book/general/wiki_spark.png)  \n\n#### Analyze Clickstream using GraphFrames\n\n**Objective:**\nQuick tour of the upcoming GraphFrames API\n\n**Time to Complete:**\n10 mins\n\n\nPeople icons from <a href=\"http://www.icons-land.com\" target=\"_blank\">Icons Land</a>","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f7fa11b2-6aae-4926-b70b-3b5c9d35c0b4"},{"version":"CommandV1","origId":503877321546916,"guid":"a946e34a-c278-4409-95c5-c66c484e4faf","subtype":"command","commandType":"auto","position":3.0,"command":"%md Attach to, and then restart your cluster first to clear out old memory caches and get to a default, standard environment. The restart should take 1 - 2 minutes.\n\n![Restart Cluster](http://curriculum-release.s3-website-us-west-2.amazonaws.com/wiki-book/general/restart_cluster.png)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dac33f6f-60a8-4218-b2c8-f5867db9f81a"},{"version":"CommandV1","origId":503877321546917,"guid":"78be7bcf-f660-47b1-bd11-3ef45e72088c","subtype":"command","commandType":"auto","position":4.0,"command":"sqlContext.setConf(\"spark.sql.shuffle.partitions\", \"60\")","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7ab167d9-8388-4752-9f6a-88deec4db765"},{"version":"CommandV1","origId":503877321546918,"guid":"88058757-0731-4fad-bdc5-f954264a785a","subtype":"command","commandType":"auto","position":5.0,"command":"%md ####![Wikipedia Logo Tiny](http://curriculum-release.s3-website-us-west-2.amazonaws.com/wiki-book/general/logo_wikipedia_tiny.png) ![Spark Logo Tiny](http://curriculum-release.s3-website-us-west-2.amazonaws.com/wiki-book/general/logo_spark_tiny.png) **Introduction: Graph Fundamentals **","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8d79337a-80a3-4430-80da-6359a11f4ef5"},{"version":"CommandV1","origId":503877321546919,"guid":"86acd099-3e73-4bf3-ada7-bad8c118d6e7","subtype":"command","commandType":"auto","position":6.0,"command":"%md Graphs are made of vertices (the nodes) and edges (the connections):","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7f0fb7f0-2b0e-4049-8996-1dfd8a355268"},{"version":"CommandV1","origId":503877321546920,"guid":"eb99e0ba-be4d-4064-a856-18f2048b151b","subtype":"command","commandType":"auto","position":7.0,"command":"%md ![Spark and Kevin](http://curriculum-release.s3-website-us-west-2.amazonaws.com/wiki-book/graph/spark_hadoop.png)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"14397911-7ce9-4f89-9851-436308ac55b4"},{"version":"CommandV1","origId":503877321546921,"guid":"86e84104-303d-4351-afe1-bc10c1878088","subtype":"command","commandType":"auto","position":8.0,"command":"%md Each vertex has an ID (the unique article ID) and each edge has a label (number of clicks and connection type):","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c7c357a0-0e0a-470c-91df-60eed1f6e600"},{"version":"CommandV1","origId":503877321546922,"guid":"2ad30ae6-5f4c-4081-9e38-683a45b2c694","subtype":"command","commandType":"auto","position":9.0,"command":"%md ![Spark and Hadoop](http://curriculum-release.s3-website-us-west-2.amazonaws.com/wiki-book/graph/spark_hadoop_detailed.png)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7b70a964-973c-4234-9631-a339bae40cc8"},{"version":"CommandV1","origId":503877321546923,"guid":"dc373806-5557-4115-b1ec-c45c9baf6c44","subtype":"command","commandType":"auto","position":10.0,"command":"%md A GraphFrame is created by combining a vertices dataframe with a edges dataframe:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b2fdd293-d195-42f1-8cb7-0bcacd3e937a"},{"version":"CommandV1","origId":503877321546924,"guid":"eb7911f9-da2f-45fc-9c8f-51919c32f62c","subtype":"command","commandType":"auto","position":11.0,"command":"%md ![Spark GraphFrame](http://curriculum-release.s3-website-us-west-2.amazonaws.com/wiki-book/graph/creating_gf.png)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2da87503-8c95-454b-8b2f-d98e3e682e78"},{"version":"CommandV1","origId":503877321546925,"guid":"df0df670-0e28-4c87-ba64-0c6a311d2f76","subtype":"command","commandType":"auto","position":12.0,"command":"%md Read the vertices dataframe and cache it:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6ba5d330-e5eb-4954-9b52-4cd2549a4792"},{"version":"CommandV1","origId":503877321546926,"guid":"3c8efa0f-74dd-490e-a9e1-b174f2cf39dd","subtype":"command","commandType":"auto","position":13.0,"command":"val verticesDF = sqlContext\n  .read\n  .parquet(\"/mnt/wikipedia-readonly/gx_clickstream/vertices\")\n  .cache","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"31db153a-2791-414b-9ead-feca9432f0e4"},{"version":"CommandV1","origId":503877321546927,"guid":"0cf73df8-b852-4308-8bfc-b5ebeef93bcb","subtype":"command","commandType":"auto","position":14.0,"command":"verticesDF.show(5)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"44c181b3-75c3-48b5-82d9-5e8e7b812072"},{"version":"CommandV1","origId":503877321546928,"guid":"e33c7417-959c-4b8b-adf9-b89d71b83b4f","subtype":"command","commandType":"auto","position":15.0,"command":"%md How many vertices are in the DataFrame?","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"76100880-8e6b-4636-84bb-3d7ed63713d1"},{"version":"CommandV1","origId":503877321546929,"guid":"8395b617-732b-4fdd-9ce7-0e87dfbfe105","subtype":"command","commandType":"auto","position":16.0,"command":"// this cell will also materialize the cache\nverticesDF.count","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7f134fc2-863f-49e5-b987-5f09b5b34868"},{"version":"CommandV1","origId":503877321546930,"guid":"14580bba-c143-4897-b336-b1116f463990","subtype":"command","commandType":"auto","position":17.0,"command":"%md Read the edges dataframe and cache it:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"05d296c1-0858-41df-843a-c6d4bed04faa"},{"version":"CommandV1","origId":503877321546931,"guid":"106af750-9fcc-42ef-bec6-65177c2fda97","subtype":"command","commandType":"auto","position":18.0,"command":"val edgesDF = sqlContext\n  .read\n  .parquet(\"/mnt/wikipedia-readonly/gx_clickstream/edges\")\n  .cache","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"68f858d2-2a37-4ffc-b3c1-d6cf0a2d0773"},{"version":"CommandV1","origId":503877321546932,"guid":"2d9fcbd5-f34c-44b7-b3c6-717ed2362416","subtype":"command","commandType":"auto","position":19.0,"command":"edgesDF.show(5)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7be572df-3094-4658-be86-3a7ce05cf959"},{"version":"CommandV1","origId":503877321546933,"guid":"bdb8991b-48bc-402d-a480-6732b307d75c","subtype":"command","commandType":"auto","position":20.0,"command":"%md How many edges are in the DataFrame?","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"01ef5192-392e-486f-b26a-393ab70a6f0c"},{"version":"CommandV1","origId":503877321546934,"guid":"375f05f2-03a9-4019-a8ce-aafbf00a2dd6","subtype":"command","commandType":"auto","position":21.0,"command":"// this cell will also materialize the cache\n// 85 sec to run\nedgesDF.count","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5e87bc92-d414-40bd-9766-62444e50d64a"},{"version":"CommandV1","origId":503877321546935,"guid":"1e9b914b-dabd-4cd5-9155-3ef58700d22b","subtype":"command","commandType":"auto","position":22.0,"command":"%md Combine the verticesDF and edgesDF into a GraphFrame:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"941c35e3-b6c7-4d6c-ad10-45d12c6f732d"},{"version":"CommandV1","origId":503877321546936,"guid":"43c40be4-922e-4bb0-94c3-321123855077","subtype":"command","commandType":"auto","position":23.0,"command":"%md Before we can do anything, we need the <a href=\"https://github.com/graphframes/graphframes.github.io\" target=\"_blank\">Graph Frames API</a>.\n0. Open your workspace\n0. Right-click > Create > Library\n0. Change the source to **Maven Coordinate**\n0. Click **Search SparkPackages and Maven Central**\n0. Search for **graphframes**\n0. Select the correct release\n0. Click **Select**\n0. Click **Create Library**\n0. Click **Attach automatically to all clusters.**\n0. Restart your cluster","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"42a1e48e-95b3-4ff6-8404-1aa4c959321b"},{"version":"CommandV1","origId":503877321546937,"guid":"9002d4e6-0af8-4ea1-817a-fa14b332d940","subtype":"command","commandType":"auto","position":24.0,"command":"import org.graphframes._","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d8570d60-6712-4882-9ab8-17eca3cd7f1a"},{"version":"CommandV1","origId":503877321546938,"guid":"273ce8b0-dc80-45c3-932e-e8aa3ca5ddb2","subtype":"command","commandType":"auto","position":25.0,"command":"val clickstreamGRAPH = GraphFrame(verticesDF, edgesDF)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"63798e58-167d-4ce4-abda-350430f29bf4"},{"version":"CommandV1","origId":503877321546939,"guid":"87c3277f-cebb-4caf-ab63-140a113f1a2b","subtype":"command","commandType":"auto","position":26.0,"command":"%md A vertex can point to many other vertices:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3c4d09c5-b747-4689-9589-bf12e2f8d47f"},{"version":"CommandV1","origId":503877321546940,"guid":"9ec001a2-14ef-4a96-9bdf-01b07d893411","subtype":"command","commandType":"auto","position":27.0,"command":"%md ![Spark and Kevin](http://curriculum-release.s3-website-us-west-2.amazonaws.com/wiki-book/graph/spark_to_3ver.png)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f8cc2654-0d0a-4eb1-b92f-2a3fe3338f23"},{"version":"CommandV1","origId":503877321546941,"guid":"8b485a37-3259-43b3-8564-1e964ae4d68a","subtype":"command","commandType":"auto","position":28.0,"command":"%md Above we see that the Spark article sent 808 clicks to the Hadoop article, 643 clicks to Matei and 322 to Mesos.\n\nHere's the corresponding DataFrames query:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c826979d-21d8-4eeb-bdb5-96cc415cca6e"},{"version":"CommandV1","origId":503877321546942,"guid":"94390a1c-1896-4654-a3de-d21e316014c3","subtype":"command","commandType":"auto","position":29.0,"command":"clickstreamGRAPH.edges.filter($\"src_title\" === \"Apache_Spark\").orderBy($\"n\".desc).show(8)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"914027f6-b802-49e3-a34e-7ea2b986d264"},{"version":"CommandV1","origId":503877321546943,"guid":"da9bdf59-fc5f-4303-9b33-01ccef969592","subtype":"command","commandType":"auto","position":30.0,"command":"%md Other vertices may also refer traffic to the Spark article:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9fb9cbf1-3537-43f6-a00d-f5a647c97c7a"},{"version":"CommandV1","origId":503877321546944,"guid":"bf5a1f73-0827-45df-bad2-8e51cc4ca079","subtype":"command","commandType":"auto","position":31.0,"command":"%md ![Spark Graph](http://curriculum-release.s3-website-us-west-2.amazonaws.com/wiki-book/graph/spark_graph.png)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b46e0513-463a-4036-a802-9d70281af021"},{"version":"CommandV1","origId":503877321546945,"guid":"afddd405-0284-4238-b40e-ebed4807e0b7","subtype":"command","commandType":"auto","position":32.0,"command":"%md Above and below, notice that Google sent 14,361 clicks to Apache Spark. The Hadoop article sent 901 clicks to Spark, while Spark sent 808 clicks to Hadoop.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"070c69fb-bf22-433c-aadc-f3d264bd4d10"},{"version":"CommandV1","origId":503877321546946,"guid":"4b4114f9-0054-4ec2-958b-f55934f124f0","subtype":"command","commandType":"auto","position":33.0,"command":"clickstreamGRAPH.edges.filter($\"dst_title\" === \"Apache_Spark\").orderBy($\"n\".desc).show(8)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9b7818f9-cb8c-422a-8dc0-b4ebbd106bc0"},{"version":"CommandV1","origId":503877321546947,"guid":"8ebdba27-c55c-4215-b5b8-7ae93673948b","subtype":"command","commandType":"auto","position":34.0,"command":"%md More accurately, there is only one Hadoop article. It has 2 unidirectional edges to the Spark article:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8aecf3d2-9a3c-45d0-bfc1-35b3058aeceb"},{"version":"CommandV1","origId":503877321546948,"guid":"0101d0dc-9940-4f11-8ee6-2870b7c4ccb1","subtype":"command","commandType":"auto","position":35.0,"command":"%md ![Spark Graph Fixed](http://curriculum-release.s3-website-us-west-2.amazonaws.com/wiki-book/graph/spark_graph_fixed.png)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7a917be8-352a-4737-aa56-ae26fc5816b0"},{"version":"CommandV1","origId":503877321546949,"guid":"9b8c2c24-6f13-4291-8ba7-83f68c49d7aa","subtype":"command","commandType":"auto","position":36.0,"command":"%md ####![Wikipedia Logo Tiny](http://curriculum-release.s3-website-us-west-2.amazonaws.com/wiki-book/general/logo_wikipedia_tiny.png) **Graphs are Everywhere..**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"62cd6ebd-755e-454f-b3e3-cfc93992a568"},{"version":"CommandV1","origId":503877321546950,"guid":"14ba37bc-a087-4f79-9755-f0af7d43c6f6","subtype":"command","commandType":"auto","position":37.0,"command":"%md Graphs appear all over the place. Sometimes they're obvious to spot in the data, other times they're hidden. Consider a few examples:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f1c0c2e9-a847-4439-a9de-d18e4d126587"},{"version":"CommandV1","origId":503877321546951,"guid":"a4d9c14e-5720-4c50-9fd8-e1298a8aaed6","subtype":"command","commandType":"auto","position":38.0,"command":"%md The following diagram shows 20 Wikipedians editing 4 articles:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b468e568-7554-4ec7-938f-5b62bcb81610"},{"version":"CommandV1","origId":503877321546952,"guid":"cf497f91-758c-4f9b-a916-af3c78032bbf","subtype":"command","commandType":"auto","position":39.0,"command":"%md ![Wikipedians Edits Graph title](http://curriculum-release.s3-website-us-west-2.amazonaws.com/wiki-book/graph/wikipedians_edits_graph_title.png)\n\n![Wikipedians Edits Graph](http://curriculum-release.s3-website-us-west-2.amazonaws.com/wiki-book/graph/wikipedians_edits_graph.png)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"709de75a-ecf1-48be-afe2-3c6d64e814e0"},{"version":"CommandV1","origId":503877321546953,"guid":"6e0f9027-1fc3-4cf0-bb51-5a34d8791c24","subtype":"command","commandType":"auto","position":40.0,"command":"%md The Wikipedians above consist of:\n- 5 sports players\n- 5 pilots\n- 4 artists\n- 4 medical staff\n- 1 firefigher\n- 1 pizza deliverer \n\nWhen looking at the editors of the <a href=\"https://en.wikipedia.org/wiki/2016_Summer_Olympics\" target=\"_blank\">Rio 2016 Summer Olympics article</a>, notice that the swimmer, judo and soccer players have thicker orange lines than the 2 american football players. The thickness of the line idicates how many edits each person did. Since the Summer Olympics don't have american football, perhaps football players have less interest in the Olympics?\n\nAmong the artists, the 2 actors and movie producer did the most edits to the <a href=\"https://en.wikipedia.org/wiki/Academy_Awards\" target=\"_blank\">Academy Awards article</a>, while the musician and pizza deliverer contributed just a little.\n\nThe violin player seems interested in both the <a href=\"https://en.wikipedia.org/wiki/Academy_Awards\" target=\"_blank\">Academy Awards</a> and <a href=\"https://en.wikipedia.org/wiki/CRISPR\" target=\"_blank\">CRISPR</a>.\n\nMostly the medical staff (doctors, nurse, pharmacist) are editing the <a href=\"https://en.wikipedia.org/wiki/CRISPR\" target=\"_blank\">CRISPR article</a>. CRISPR is a new genome/DNA editing tool that could transform the field of biology and genetic engineering. \n\nThe 2 commercial pilots look like they did more edits to the <a href=\"https://en.wikipedia.org/wiki/Boeing_777X\" target=\"_blank\">Boeing 777x article</a>, than the 3 military pilots... probably because the $400 million dollar 777x plane, which is planned for release in 2020, is going to be a commercial airplane.\n\nThe pizza delivery woman seems to have pretty diverse interests.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e6033b68-8f9e-4f57-b7b5-77142f3cb03b"},{"version":"CommandV1","origId":503877321546954,"guid":"15e8bc04-4e8a-4a19-9b88-3d5541d78693","subtype":"command","commandType":"auto","position":41.0,"command":"%md All of the links in the Wikipedia articles also make a graph:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"52e1c6af-ad2e-4bbd-8e94-16af2e241554"},{"version":"CommandV1","origId":503877321546955,"guid":"a91b1901-a976-4632-b463-747ddb612215","subtype":"command","commandType":"auto","position":42.0,"command":"%md \n![En Wikipedia Graph Title](http://curriculum-release.s3-website-us-west-2.amazonaws.com/wiki-book/graph/en_wiki_graph_title.png)\n\n![En Wikipedia Spark Graph](http://curriculum-release.s3-website-us-west-2.amazonaws.com/wiki-book/graph/en_wiki_graph_spark.png)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"da6fc9ad-c369-4255-9908-6d72d9642c8c"},{"version":"CommandV1","origId":503877321546956,"guid":"924e89a2-81b9-4f4b-8c8f-3b0324681d05","subtype":"command","commandType":"auto","position":43.0,"command":"%md Can you guess what this graph shows?","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9082cf0b-eafb-4437-8fc2-006c5836ed82"},{"version":"CommandV1","origId":503877321546957,"guid":"5c3e8427-84d7-4550-a4d0-7d4540db9341","subtype":"command","commandType":"auto","position":44.0,"command":"%md ![Sock graph](http://curriculum-release.s3-website-us-west-2.amazonaws.com/wiki-book/graph/sock_graph.png)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b5e8906e-88b7-46dc-a531-7d2eb6797972"},{"version":"CommandV1","origId":503877321546958,"guid":"1b7f63ae-7bab-402e-b130-ab05709ce82c","subtype":"command","commandType":"auto","position":45.0,"command":"%md The above graph was created by the Wikimedia Foundation. Following an investigation named <a href=\"https://en.wikipedia.org/wiki/Wikipedia:Long-term_abuse/Orangemoody\" target=\"_blank\">Orangemoody\"</a>, WMF identified 381 malicious Wikipedia editor IPs/accounts who were creating promotional articles, inserting promotional external links and doing disruptive edits for profit.\n\nYellow bubbles represent IP addresses of anon editors, and green bubbles represent accounts with usernames.\n\nAll 381 accounts were blocked from editing Wikipedia.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"94efa1ef-62c9-4dce-99fb-72e540621d39"},{"version":"CommandV1","origId":503877321546959,"guid":"5386b95a-2958-49b0-b99b-28b392031227","subtype":"command","commandType":"auto","position":46.0,"command":"%md ####![Wikipedia + Spark Logo Tiny](http://curriculum-release.s3-website-us-west-2.amazonaws.com/wiki-book/general/wiki_spark_small.png) **Graph Algorithms: inDegree and outDegree**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3dc8a4ec-7b14-42fe-aee5-7f95f37b6592"},{"version":"CommandV1","origId":503877321546960,"guid":"e4b6acac-35b8-4828-afdb-1ef067de99e9","subtype":"command","commandType":"auto","position":47.0,"command":"%md The `inDegree` of a vertex shows how many edges point into it:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dc7b724e-a2d5-4ba3-b2a6-0af3a4534cb6"},{"version":"CommandV1","origId":503877321546961,"guid":"4c48105f-b2ec-4456-bef2-3762ffbe5b98","subtype":"command","commandType":"auto","position":48.0,"command":"%md ![inDegree](http://curriculum-release.s3-website-us-west-2.amazonaws.com/wiki-book/graph/indegree.png)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"18ec3970-07ac-48db-9e57-05c292edc4fa"},{"version":"CommandV1","origId":503877321546962,"guid":"8f83251b-ed64-4fc0-8126-4c67c7d83165","subtype":"command","commandType":"auto","position":49.0,"command":"%md To calculate the `inDegree` of the Apache Spark article, start by getting the article id:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5eab1c57-bd8c-49c9-b1bc-94cdd45a4fb1"},{"version":"CommandV1","origId":503877321546963,"guid":"6a9789dd-546a-4605-a5f0-d441445c533a","subtype":"command","commandType":"auto","position":50.0,"command":"clickstreamGRAPH.vertices.filter($\"id_title\" === \"Apache_Spark\").show","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3f86565e-075a-4ded-a502-f7d27765baee"},{"version":"CommandV1","origId":503877321546964,"guid":"00a3a104-71f7-45a2-a82c-93c78f2988f7","subtype":"command","commandType":"auto","position":51.0,"command":"%md Then get the `inDegree` of all the vertices and filter for just the Apache Spark article:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3296104a-7269-4841-9e7a-cff8efe4bdd5"},{"version":"CommandV1","origId":503877321546965,"guid":"60199dd6-a297-417d-b34a-ddf1c29ace17","subtype":"command","commandType":"auto","position":52.0,"command":"clickstreamGRAPH.inDegrees.filter($\"id\" === 42164234).show()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7f1ed224-dfe6-4455-be25-4d5f9a98d379"},{"version":"CommandV1","origId":503877321546966,"guid":"6a94d15f-af12-45b7-89dd-18d3cc98d545","subtype":"command","commandType":"auto","position":53.0,"command":"%md So, traffic from 33 other unique articles clicked into the Apache Spark article in Feb 2015.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0262b502-d780-48f8-bcf8-804c12b78a1c"},{"version":"CommandV1","origId":503877321546967,"guid":"3b0e2792-421a-4e55-90ae-5407f446ade0","subtype":"command","commandType":"auto","position":54.0,"command":"%md The `outDegree` of a vertex shows how many edges point out of it:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8b8dcb9f-8ded-495a-b3c9-0070dcdcdf68"},{"version":"CommandV1","origId":503877321546968,"guid":"3947d026-9312-4c10-9dc3-98fb4a7f5d7d","subtype":"command","commandType":"auto","position":55.0,"command":"%md ![outDegree](http://curriculum-release.s3-website-us-west-2.amazonaws.com/wiki-book/graph/outdegree.png)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5a9d320b-d041-4756-8f30-58aa36621102"},{"version":"CommandV1","origId":503877321546969,"guid":"e67e6133-f372-4d3f-95b0-641b570b96a7","subtype":"command","commandType":"auto","position":56.0,"command":"%md Query the `outDegree` of all the vertices and filter for just the Apache Spark article:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"913cf06e-4eaa-460b-bd3f-6e3712c71413"},{"version":"CommandV1","origId":503877321546970,"guid":"48373fa7-471e-4a81-9f97-00842e82ae1e","subtype":"command","commandType":"auto","position":57.0,"command":"clickstreamGRAPH.outDegrees.filter($\"id\" === 42164234).show()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"39e2ee95-c73a-4fbd-9431-51d3e4c5239f"},{"version":"CommandV1","origId":503877321546971,"guid":"d66f0984-72af-4e75-b4be-4109933b38fd","subtype":"command","commandType":"auto","position":58.0,"command":"%md The Apache Spark article sent traffic to 30 other unqiue articles.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a141bd27-e4e1-4be8-a15e-b99a15a12cd7"},{"version":"CommandV1","origId":503877321546972,"guid":"559995b5-d63e-4193-a036-7f4c8fa40aac","subtype":"command","commandType":"auto","position":59.0,"command":"%md ####![Wikipedia + Spark Logo Tiny](http://curriculum-release.s3-website-us-west-2.amazonaws.com/wiki-book/general/wiki_spark_small.png) **Graph Algorithms: SubGraph**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6c4e04f8-228f-401b-94aa-3a7dffdfb614"},{"version":"CommandV1","origId":503877321546973,"guid":"9bfaefb0-ea45-4d30-95ce-0112c9811a38","subtype":"command","commandType":"auto","position":60.0,"command":"printf(\"%,d vertices\\n\", clickstreamGRAPH.vertices.count)\n\nval verticesSubgraphDF = clickstreamGRAPH.vertices.filter($\"id_title\" !== \"Main_Page\")\nval count = verticesSubgraphDF.cache.count // cache and materialize\n\nprintf(\"%,d sub-vertices\\n\\n\", count)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7634aac7-fad7-4569-863b-432f8eb4fe57"},{"version":"CommandV1","origId":503877321546974,"guid":"96bd1d6c-bb67-4a9a-89bc-73763ceceda0","subtype":"command","commandType":"auto","position":61.0,"command":"verticesSubgraphDF.show(4)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c171ecd2-48c3-4826-a95f-efc6e369110c"},{"version":"CommandV1","origId":503877321546975,"guid":"cffe6715-fd37-482f-b0a6-e60eb102bcdf","subtype":"command","commandType":"auto","position":62.0,"command":"printf(\"%,d edges\\n\", edgesDF.count)\n\nval edgesSubgraphDF = edgesDF.filter(\"n > '300'\").filter($\"src\" !== 15580374).filter($\"dst\" !== 15580374)\nval count = edgesSubgraphDF.cache.count // cache and materialize\n\nprintf(\"%,d sub-edges\\n\\n\", count)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a7b44117-c32f-40c3-bf9a-f6399269d922"},{"version":"CommandV1","origId":503877321546976,"guid":"cd97f5d2-82a2-4ec7-b87b-f0d1f67722ae","subtype":"command","commandType":"auto","position":63.0,"command":"edgesSubgraphDF.show(4)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"07fafb31-62f9-423c-84e4-fab4f93fd516"},{"version":"CommandV1","origId":503877321546977,"guid":"1d01a811-4812-4063-ade2-de8ce874e412","subtype":"command","commandType":"auto","position":64.0,"command":"val edgesSubgraphDF2 = edgesDF\n.filter($\"src\" !== 15580374) //remove main page\n.filter($\"dst\" !== 15580374)\n.filter($\"src_title\" !== \"other-google\")\n.filter($\"src_title\" !== \"other-wikipedia\")\n.filter($\"src_title\" !== \"other-empty\")\n.filter($\"src_title\" !== \"other-bing\")\n.filter($\"src_title\" !== \"other-twitter\")\n.filter($\"src_title\" !== \"other-facebook\")\n.filter($\"src_title\" !== \"other-other\")\n.filter($\"src_title\" !== \"other-yahoo\")\n.filter($\"src_title\" !== \"other-internal\")\n\nprintf(\"%,d sub-edges\\n\\n\", edgesSubgraphDF2.count)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f78e5754-b620-452d-8284-3def647f6033"},{"version":"CommandV1","origId":503877321546978,"guid":"fa47c06d-7d4f-456b-96e5-f4d1a8433c18","subtype":"command","commandType":"auto","position":65.0,"command":"val clickstreamSubGRAPH = GraphFrame(verticesSubgraphDF, edgesSubgraphDF2)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6cdd4045-901b-46c9-b8ea-82352734d6b5"},{"version":"CommandV1","origId":503877321546979,"guid":"b409058e-ceeb-49ae-962f-9ea1354be92f","subtype":"command","commandType":"auto","position":66.0,"command":"%md ####![Wikipedia + Spark Logo Tiny](http://curriculum-release.s3-website-us-west-2.amazonaws.com/wiki-book/general/wiki_spark_small.png) **Graph Algorithm: Shortest Path**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8aeed0a0-2c0e-4640-b502-9f571667d688"},{"version":"CommandV1","origId":503877321546980,"guid":"8e9909e3-399e-4ce3-93ca-460c33a9e54a","subtype":"command","commandType":"auto","position":67.0,"command":"%md ![Shortest Path Question](http://curriculum-release.s3-website-us-west-2.amazonaws.com/wiki-book/graph/shortest_path_q.png)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"78c1269a-9b68-49e2-9b2a-25a227f51472"},{"version":"CommandV1","origId":503877321546981,"guid":"fd9a51e5-9218-4fcc-b05a-243807a48296","subtype":"command","commandType":"auto","position":68.0,"command":"clickstreamGRAPH.vertices.filter($\"id_title\" === \"Apache_Spark\").show","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d206aec6-9e5f-4d3a-8a88-9d99239596ed"},{"version":"CommandV1","origId":503877321546982,"guid":"15208449-b828-4219-ad0f-118933d051fc","subtype":"command","commandType":"auto","position":69.0,"command":"clickstreamGRAPH.vertices.filter($\"id_title\" === \"Kevin_Bacon\").show","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"542931cd-23bd-473e-aeb5-87718300e083"},{"version":"CommandV1","origId":503877321546983,"guid":"ccc1835a-a4e5-4e88-8f9a-5650c857b978","subtype":"command","commandType":"auto","position":70.0,"command":"//spark\nclickstreamSubGRAPH.outDegrees.filter($\"id\" === 42164234).show()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0e6910b8-ced6-4c8e-b7d5-ef28b6846e55"},{"version":"CommandV1","origId":503877321546984,"guid":"d5ccc535-c25b-45dc-a24a-878039110b7f","subtype":"command","commandType":"auto","position":71.0,"command":"//kevin\nclickstreamSubGRAPH.inDegrees.filter($\"id\" === 16827).show()","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6a7da490-3ec0-4fba-9502-30861cd77c43"},{"version":"CommandV1","origId":503877321546985,"guid":"2379c49b-2612-4dda-89c6-cf972670f77c","subtype":"command","commandType":"auto","position":72.0,"command":"%md Breadth-first search (BFS) finds the shortest path(s) from one vertex to another vertex:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8c6141c5-a2e9-46eb-b46a-ed5a083ab705"},{"version":"CommandV1","origId":503877321546986,"guid":"fa27c05f-082c-4bad-bda7-43ce1c6ca5bf","subtype":"command","commandType":"auto","position":73.0,"command":"// 7-8 mins to run\nval shortestPathDF =  clickstreamSubGRAPH.bfs.fromExpr(\"id = 42164234\").toExpr(\"id = 16827\").run() ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"af026a5f-a457-4d5f-9d4d-f308686cae9e"},{"version":"CommandV1","origId":503877321546987,"guid":"869281e4-99ce-4b57-9f02-398075d31a59","subtype":"command","commandType":"auto","position":74.0,"command":"//How many results did we get?\n\n// 4 mins to run\nshortestPathDF.cache.count","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1d4c9a3f-9b1d-4719-8a66-9b21a77193e9"},{"version":"CommandV1","origId":503877321546988,"guid":"a6297c42-1866-4ba8-afa9-87026b81d6b2","subtype":"command","commandType":"auto","position":75.0,"command":"display(shortestPathDF)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d4e6a7ad-dd88-491c-ace1-5a550d8d94ac"},{"version":"CommandV1","origId":503877321546989,"guid":"2942b257-6065-401e-b25a-8011a1b55b9a","subtype":"command","commandType":"auto","position":76.0,"command":"%md ####![Wikipedia + Spark Logo Tiny](http://curriculum-release.s3-website-us-west-2.amazonaws.com/wiki-book/general/wiki_spark_small.png) **Graph Algorithm: PageRank**","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2ccbb7ba-1765-49cc-9fd1-457f3da134ec"},{"version":"CommandV1","origId":503877321546990,"guid":"ae997648-cd52-4469-bf03-2d0c3b84c295","subtype":"command","commandType":"auto","position":77.0,"command":"// 13 mins to run\nval prGRAPH = clickstreamGRAPH.pageRank.maxIter(3).run()  //621.45s to run ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ac02ad95-66b7-4451-9309-aef4d78ef495"},{"version":"CommandV1","origId":503877321546991,"guid":"2adacba7-e2e1-411d-a730-87176ed1cc54","subtype":"command","commandType":"auto","position":78.0,"command":"prGRAPH.vertices.show(10)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"41f8b6b7-a63e-4039-bb4f-384d3f41e89d"},{"version":"CommandV1","origId":503877321546992,"guid":"0a9ea8a3-c414-418b-9579-2a15f252c9b0","subtype":"command","commandType":"auto","position":79.0,"command":"display(prGRAPH.vertices.orderBy($\"pagerank\".desc).limit(30))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e68d37b4-3ba2-4220-b5b5-076891a664d2"}],"dashboards":[],"guid":"1a490247-94af-40e9-8430-bc69339d6a8f","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}