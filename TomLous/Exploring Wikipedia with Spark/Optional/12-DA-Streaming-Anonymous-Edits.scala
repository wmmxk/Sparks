{"version":"NotebookV1","origId":503877321546663,"name":"12-DA-Streaming-Anonymous-Edits","language":"scala","commands":[{"version":"CommandV1","origId":503877321546665,"guid":"57e89a49-5b96-4579-bd4b-848b07e3a798","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n# Spark Streaming and Wikipedia ![Wikipedia Logo](http://sameerf-dbc-labs.s3-website-us-west-2.amazonaws.com/data/wikipedia/images/w_logo_for_labs.png)\n\n## Solutions to Exercises and Questions","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f1023b3a-c2aa-4412-844e-5fab9541ae0a"},{"version":"CommandV1","origId":503877321546666,"guid":"db156957-1d48-4a33-b18f-29ca0d9124ee","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n### Exercise 1\n\n_Remove the United States, Canada, Australia, New Zealand and the UK from the data and re-plot the results, to see who's editing English Wikipedia entries from countries where English is not the primary language._","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0cf9ecd0-2ee4-49ef-a1c7-5260af5fe4bc"},{"version":"CommandV1","origId":503877321546667,"guid":"2b0fc876-2dbd-490d-9063-b4364e8bf6a8","subtype":"command","commandType":"auto","position":3.0,"command":"%md \nThere are several possible solutions to this exercise. Here's one:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5aa1d180-179a-4647-9477-be51dbd7674d"},{"version":"CommandV1","origId":503877321546668,"guid":"73b89a9f-05e6-4b6d-ab76-3426f6443a42","subtype":"command","commandType":"auto","position":4.0,"command":"display(anonDFCounts.filter(($\"country\" !== \"USA\") && ($\"country\" !== \"GBR\") && ($\"country\" !== \"CAN\") && ($\"country\" !== \"AUS\") && ($\"country\" !== \"NZL\")))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"442f201b-9fe5-4b9f-acba-1588dc1b88cc"},{"version":"CommandV1","origId":503877321546669,"guid":"06fcd380-9a34-4993-96cd-c5c9679f02e3","subtype":"command","commandType":"auto","position":5.0,"command":"%md\nBut this one's more compact:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"70a42444-9092-4461-840d-47effc194a26"},{"version":"CommandV1","origId":503877321546670,"guid":"4ca2c66b-7878-4dd5-8414-8af441f87993","subtype":"command","commandType":"auto","position":6.0,"command":"display(anonDFCounts.filter(! ($\"country\".isin(\"USA\", \"CAN\", \"GBR\", \"AUS\", \"NZL\"))))","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5ea35ad0-b8cd-434d-a28c-4f0f69344d43"},{"version":"CommandV1","origId":503877321546671,"guid":"27c082d5-7792-4a7a-8d08-343ade2ffe57","subtype":"command","commandType":"auto","position":7.0,"command":"%md\n### Exercise 2\n\n_Choose another language, and figure out where_ that _Wikipedia is being edited. The server currently serves up changes for the following Wikipedias_","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1e5096b3-fb3c-4295-9f69-1092ede744fc"},{"version":"CommandV1","origId":503877321546672,"guid":"589a1983-3f56-4e4b-8535-7640822b9889","subtype":"command","commandType":"auto","position":8.0,"command":"val code = \"es\" // easy to change in one place\nval langDF = cleanedDF.filter(($\"wikipedia\" === code) && ($\"isAnonymous\" === true))\n                      .select($\"user\".as(\"ipAddress\"), $\"geoCountryCode3\".as(\"country\"))\n                      .filter(! isnull($\"country\"))\n                      .groupBy($\"ipAddress\", $\"country\")\n                      .count()\n                      .select($\"country\", $\"count\")\ndisplay(langDF)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3cce63e3-49de-41c0-8a48-abc1e631066e"}],"dashboards":[],"guid":"03e3246b-6c1f-4160-a371-09b5a753a4e9","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}