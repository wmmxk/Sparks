{"version":"NotebookV1","origId":503877321546274,"name":"08-Solutions","language":"scala","commands":[{"version":"CommandV1","origId":503877321546276,"guid":"d739f9cd-0a91-4282-8309-c2f3130cf5dc","subtype":"command","commandType":"auto","position":1.0,"command":"%md ### Solutions to 08 Wiki NLP lab","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"49d4ed8c-41b0-48ce-9e0a-3b4cda11745e"},{"version":"CommandV1","origId":503877321546277,"guid":"675eeceb-c344-492b-ba21-9356f53fec0f","subtype":"command","commandType":"auto","position":2.0,"command":"%md **Solutions to Question #1: ** How many days of data is in the DataFrame?","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2cfa7430-73d9-463d-9036-479dca439f5e"},{"version":"CommandV1","origId":503877321546278,"guid":"230da9b8-cb52-45f7-aef9-f4788664ba2d","subtype":"command","commandType":"auto","position":3.0,"command":"// Challenge 1:  Can you write this query using DataFrames? Hint: Start by importing the sql.functions.\n\n\nimport org.apache.spark.sql.functions._\nwikiDF.select(dayofyear($\"lastrev_pdt_time\")).distinct().show","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"11d5f283-4913-42e1-b92f-6eaa1451f3dc"},{"version":"CommandV1","origId":503877321546279,"guid":"5d38bf0f-ee50-4fbb-a947-dbc2bbd725ce","subtype":"command","commandType":"auto","position":4.0,"command":"%md **Solutions to Question #2: ** How many of the 1 million articles were last edited by [ClueBot NG](https://en.wikipedia.org/wiki/User:ClueBot_NG), an anti-vandalism bot?","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6b366832-af76-44da-9515-c8d1c897597a"},{"version":"CommandV1","origId":503877321546280,"guid":"02c57ba6-6a9f-4dd3-9fe1-bf472e5813d7","subtype":"command","commandType":"auto","position":5.0,"command":"// Answer to Challenge 2\n// Write a SQL query to answer this question. The username to search for is `ClueBot BG`.\n\n%sql SELECT COUNT(*) FROM wikipedia WHERE contributorusername = \"ClueBot NG\";\n\n%sql SELECT * FROM wikipedia WHERE contributorusername = \"ClueBot NG\" LIMIT 10;","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"80bb2bae-bdca-479d-9589-24f1c2fe2f79"}],"dashboards":[],"guid":"3e4fe183-1bcd-4f50-b7a2-bd23ec9cfd56","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}