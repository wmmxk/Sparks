{"version":"NotebookV1","origId":503877321547422,"name":"02-Solutions","language":"scala","commands":[{"version":"CommandV1","origId":503877321547424,"guid":"a925a649-a086-4eec-a862-56be720d2f03","subtype":"command","commandType":"auto","position":1.0,"command":"%md ### Solutions to 02_DE-Pageviews RunMe lab","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"014368ae-bbac-4cd3-8e68-98ef3645ba17"},{"version":"CommandV1","origId":503877321547425,"guid":"6901d438-7019-426c-83a0-5fdae0cb310d","subtype":"command","commandType":"auto","position":2.0,"command":"%md **Solution to Question #1:** How many rows in the table refer to mobile vs desktop?","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7dba67b0-264d-4713-a172-9eb67af4cfe6"},{"version":"CommandV1","origId":503877321547426,"guid":"f09da200-30b6-42f3-828d-b76912eca767","subtype":"command","commandType":"auto","position":3.0,"command":"%md **Challenge 1: ** How many rows refer to desktop?","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4cec478d-0407-4bdb-8904-ea7493ab1a69"},{"version":"CommandV1","origId":503877321547427,"guid":"884b1a4e-f147-446c-8e11-fd3d9c0d6b36","subtype":"command","commandType":"auto","position":4.0,"command":"pageviewsDF.filter($\"site\" === \"desktop\").count","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6e69ac92-92b3-4b81-8311-6c7990849b2d"},{"version":"CommandV1","origId":503877321547428,"guid":"ce35a9bd-42d1-4a5a-8e79-49a663f7cdca","subtype":"command","commandType":"auto","position":5.0,"command":"%md **Challenge 2:** Reload the table from S3, order it by the timestamp and site column (like above) and cache it:\n\nHint: Name the new DataFrame `pageviewsOrderedDF`","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dbac95f5-191a-41be-a70c-09ea3967717d"},{"version":"CommandV1","origId":503877321547429,"guid":"1fc1ec38-7ab7-4647-b656-11081f7c3d5d","subtype":"command","commandType":"auto","position":6.0,"command":"val pageviewsOrderedDF = sqlContext.read.table(\"pageviews_by_second\").orderBy($\"timestamp\", $\"site\".desc).cache","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1906f992-28ad-427f-8738-e2bdce8b0557"}],"dashboards":[],"guid":"c79102e7-f125-4f92-bd6c-03e92d8e8ef2","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}